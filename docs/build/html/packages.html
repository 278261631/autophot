<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Packages &mdash; AutoPhOT  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Commands" href="autophot_instructions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="instructions.html">Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="autophot_instructions.html">Commands</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Full Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Packages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.aperture">packages.aperture module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#packages-apply-airmass-extinction-module">packages.apply_airmass_extinction module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.call_astrometry_net">packages.call_astrometry_net module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.call_catalog">packages.call_catalog module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.call_crayremoval">packages.call_crayremoval module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.call_datacheck">packages.call_datacheck module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#packages-call-hotpants-module">packages.call_hotpants module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#packages-call-locationcheck-module">packages.call_locationcheck module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.call_yaml">packages.call_yaml module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.check_tns">packages.check_tns module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.check_wcs">packages.check_wcs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#packages-color-correction-module">packages.color_correction module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.create_plots">packages.create_plots module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.find">packages.find module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.functions">packages.functions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#packages-get-template-module">packages.get_template module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.lightcurve">packages.lightcurve module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.limit">packages.limit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.main">packages.main module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.psf">packages.psf module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#packages-recover-output-module">packages.recover_output module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#packages-rm-bkg-module">packages.rm_bkg module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages.run">packages.run module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#packages-uncertain-module">packages.uncertain module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-packages">Module contents</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Github</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Astro-Sean/autophot">AutoPhot</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Astro-Sean/autophot/tree/master/example_notebooks">Notebooks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AutoPhOT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Packages</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/packages.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="packages">
<h1>Packages<a class="headerlink" href="#packages" title="Permalink to this headline"></a></h1>
<div class="section" id="module-packages.aperture">
<span id="packages-aperture-module"></span><h2>packages.aperture module<a class="headerlink" href="#module-packages.aperture" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.aperture.compute_phot_error">
<span class="sig-prename descclassname"><span class="pre">packages.aperture.</span></span><span class="sig-name descname"><span class="pre">compute_phot_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sky_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sky_annulus_area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.aperture.compute_phot_error" title="Permalink to this definition"></a></dt>
<dd><p>Computes the flux errors using the DAOPHOT style computation. This code has been adapted from 
<a class="reference external" href="https://github.com/spacetelescope/wfc3_photometry/blob/master/photometry_tools/photometry_with_errors.py">here</a></p>
<p>This function is used in combination with aperture photometry packages. The flux error is given by:</p>
<div class="math notranslate nohighlight">
\[\delta flux = \frac{flux~variance / gain}{area_{ap} \times \sigma_{bkg} ^2 \times (1 + \frac{area_{ap}}{area_{sky,annulus}})}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux_variance</strong> (<em>float</em>) – flux variance of target</p></li>
<li><p><strong>sky_std</strong> (<em>float</em>) – standard deviation of background</p></li>
<li><p><strong>sky_annulus_area</strong> (<em>float</em>) – Area of annulus used to find standard deviation of background</p></li>
<li><p><strong>ap_area</strong> (<em>float</em>) – Area under aperture where flux variance is measured</p></li>
<li><p><strong>gain</strong> (<em>floar</em><em>, </em><em>optional</em>) – Gain of image in <span class="math notranslate nohighlight">\(e^{-}\)</span> per ADU, defaults to 1.0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Flux error of flux measurement</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.aperture.do_aperture_photometry">
<span class="sig-prename descclassname"><span class="pre">packages.aperture.</span></span><span class="sig-name descname"><span class="pre">do_aperture_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf_ap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_in_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_out_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.aperture.do_aperture_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Perform aperture photometry using two aperture sizes on a series of targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>2D array</em>) – 2D image containing sources to be measured using aperture photometry</p></li>
<li><p><strong>dataframe</strong> (<em>Dataframe</em>) – Dataframe containing <span class="math notranslate nohighlight">\(\mathit{x\_pix}\)</span> and <span class="math notranslate nohighlight">\(\mathit{y\_pix}\)</span> columns representing the X, Y pixel locations of a source.</p></li>
<li><p><strong>fwhm</strong> (<em>Float</em>) – Full Width Half Maximum (FWHM) of image. This is used to calibrated aperture and annulus size.</p></li>
<li><p><strong>ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as standard aperture size, defaults to 1.7</p></li>
<li><p><strong>inf_ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as larger, <span class="math notranslate nohighlight">\(\mathit{infinite}\)</span> aperture size, defaults to 2.5</p></li>
<li><p><strong>r_in_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as inner radius of background annulus, defaults to 1.9</p></li>
<li><p><strong>r_out_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as outer radius of background annulus, defaults to 2.2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a dataframe containing original <span class="math notranslate nohighlight">\(\mathit{x\_pix}\)</span> and <span class="math notranslate nohighlight">\(\mathit{y\_pix}\)</span> columns as well as columns  <span class="math notranslate nohighlight">\(\mathit{counts\_inf\_ap}\)</span>  and <span class="math notranslate nohighlight">\(\mathit{counts\_ap}\)</span> containing counts under the apertures given by <span class="math notranslate nohighlight">\(\mathit{ap\_size}\)</span> and <span class="math notranslate nohighlight">\(\mathit{inf\_ap\_size}\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.aperture.find_aperture_correction">
<span class="sig-prename descclassname"><span class="pre">packages.aperture.</span></span><span class="sig-name descname"><span class="pre">find_aperture_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_corr_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.aperture.find_aperture_correction" title="Permalink to this definition"></a></dt>
<dd><p>Package used to find aperture correction for use in aperture photometry.
This correction accounts for the fact that we use an aperture size of finite
size when a point source ay have flux extending out to much larger radii. This function performs aperture photometry on
several bright isolated sources using a normal aperture size and a larger aperture size. An aperture correction can then be
found using the following formula:</p>
<div class="math notranslate nohighlight">
\[apcorr = -2.5 \times  Log_{ 10 }( \frac{ F_{inf} }{ F_{ap} } )\]</div>
<p>where <span class="math notranslate nohighlight">\(F_{inf}\)</span> is the flux measured under a small aperture size and <span class="math notranslate nohighlight">\(F_{ap}\)</span> is the flux found under the normal aperture size used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>Dataframe</em>) – Dataframe containing columns with <span class="math notranslate nohighlight">\(\mathit{counts\_inf\_ap}\)</span>  and <span class="math notranslate nohighlight">\(\mathit{counts\_ap}\)</span> representing   <span class="math notranslate nohighlight">\(F_{inf}\)</span> and  <span class="math notranslate nohighlight">\(F_{ap}\)</span> respectively.</p></li>
<li><p><strong>write_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – If ap_corr_plot is True, this param is the write directory of the histogram plot of the aperture corrections. , defaults to None</p></li>
<li><p><strong>base</strong> (<em>str</em><em> , </em><em>optional</em>) – If ap_corr_plot is True, base is the filename appended onto the word “<a href="#id17"><span class="problematic" id="id18">aperture_correction_</span></a>” when naming the histogram plot of the aperture corrections. , defaults to None</p></li>
<li><p><strong>ap_corr_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, save a plot of the distribution of aperture corrections , defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Aperture corrections and error on aperture correction given by the standard deviation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.aperture.find_optimum_aperture_size">
<span class="sig-prename descclassname"><span class="pre">packages.aperture.</span></span><span class="sig-name descname"><span class="pre">find_optimum_aperture_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_in_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_out_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GAIN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RDNOISE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_optimum_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.aperture.find_optimum_aperture_size" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Find the optimum aperture radius for a given image. Although the</p>
</div></blockquote>
<p>initial guess of <span class="math notranslate nohighlight">\(1.7 \times FWHM\)</span> is a suitable guess for the
aperture size of an image. Irregular symmetric point spread functions
(PSF) may require a slightly larger or smaller aperture size. This function
uses several well isolated sources and finds their Signal to noise ratio
(S/N) using the following equation:</p>
<div class="math notranslate nohighlight">
\[S/N_{max} = \frac{ F_{ap,optimum} }{ F_{ap,optimum} + F_{sky,ap,optimum,n} + (RN ^2 + \frac{G^2}{4} \times n_{pix}) + (D \times n_{pix} \times t_{exp}) } ^{0.5}\]</div>
<p>where <span class="math notranslate nohighlight">\(F_{ap,optimum}\)</span> is the flux under an aperture of an optimum
radius, and likewise <span class="math notranslate nohighlight">\(F_{sky,ap,optimum,n}\)</span> is the flux due to the
sky background under the same aperture. By varying the size of the
aperture, we produce a curve of growth model for how the S/N ratio behaves
for different radii. This package iterations through a small radii towards
a very large radii and notes how the S/N changes for a sample of sources.
Where these sources reach a maximum (which <span class="math notranslate nohighlight">\(\mathit{should}\)</span> be the
same for all point sources) is considered the optimum aperture size, where
we obtain the option ratio of source flux and background noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>Dataframe</em>) – Dataframe containing <span class="math notranslate nohighlight">\(\mathit{x\_pix}\)</span> and <span class="math notranslate nohighlight">\(\mathit{y\_pix}\)</span> columns representing the X, Y pixel locations of a source. Dataframe source also include <span class="math notranslate nohighlight">\(\mathit{include\_fwhm}\)</span>. This column source be a boolean list where <span class="math notranslate nohighlight">\(\mathit{True}\)</span> dictates that a source source be included in the optimum radius investigation and <span class="math notranslate nohighlight">\(\mathit{False}\)</span> meaning it is excluded.</p></li>
<li><p><strong>image</strong> (<em>2D array</em>) – 2D image containing sources to be measured using aperture photometry</p></li>
<li><p><strong>exp_time</strong> (<em>float</em>) – Exposure time in seconds of image.</p></li>
<li><p><strong>fwhm</strong> (<em>Float</em>) – Full Width Half Maximum (FWHM) of image. This is used to calibrated aperture and annulus size.</p></li>
<li><p><strong>write_dir</strong> (<em>str</em>) – Directory where to place the image.</p></li>
<li><p><strong>base</strong> (<em>str</em>) – Name of file which is appended onto ‘<span class="math notranslate nohighlight">\(\mathit{target\_ap\_}\)</span>’.</p></li>
<li><p><strong>ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as standard aperture size, defaults to 1.7</p></li>
<li><p><strong>inf_ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as larger, <span class="math notranslate nohighlight">\(\mathit{infinite}\)</span> aperture size, defaults to 2.5</p></li>
<li><p><strong>r_in_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as inner radius of background annulus, defaults to 1.9</p></li>
<li><p><strong>r_out_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as outer radius of background annulus, defaults to 2.2</p></li>
<li><p><strong>GAIN</strong> (<em>float</em><em>, </em><em>optional</em>) – Gain of image in <span class="math notranslate nohighlight">\(e^{-}$ per ADU\)</span>, defaults to 1.0</p></li>
<li><p><strong>RDNOISE</strong> (<em>float</em><em>, </em><em>optional</em>) – Read Noise of image  of image in <span class="math notranslate nohighlight">\(e^{-}$ per pixel\)</span>, defaults to 0</p></li>
<li><p><strong>plot_optimum_radius</strong> (<em>boolean</em><em>, </em><em>optional</em>) – If true, saves of plot of the curve of growths for a sample of sources  saved to <span class="math notranslate nohighlight">\(\mathit{write\_dir}\)</span> with the name “<span class="math notranslate nohighlight">\(\mathit{optimum\_aperture\_}\)</span>”. + <span class="math notranslate nohighlight">\(\mathit{base}\)</span>, defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gives the optim radius in units of FWHM.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.aperture.measure_aperture_photometry">
<span class="sig-prename descclassname"><span class="pre">packages.aperture.</span></span><span class="sig-name descname"><span class="pre">measure_aperture_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkg_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.aperture.measure_aperture_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Main package to perform aperture photometry. The counts under an aperture are found using:</p>
<div class="math notranslate nohighlight">
\[counts = F_{ap} \times T_{exp} = \sum_{ap}(counts) - \langle counts_{sky} \rangle \times n\]</div>
<p>where <span class="math notranslate nohighlight">\(F_{ap}\)</span> is the flux under an aperture, <span class="math notranslate nohighlight">\(T_{exp}\)</span> is the exposure time of the observations in seconds. <span class="math notranslate nohighlight">\(\sum_{ap}(counts)\)</span> defines the counts summed up under an aperture, <span class="math notranslate nohighlight">\(\langle counts_{sky} \rangle\)</span> is the average background level assumed to be under the aperture (and the flux we want to measure) and n is the number of pixels in the aperture (<span class="math notranslate nohighlight">\(n=\pi r_{ap} ^2\)</span>, where <span class="math notranslate nohighlight">\(r_{ap}\)</span> is the radius of the aperture.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>List of Tuples</em>) – List of tuples containing x,y positions. For example:  <span class="math notranslate nohighlight">\(positions = [(1,2),(3,4)]\)</span></p></li>
<li><p><strong>image</strong> (<em>2D array</em>) – 2D image containing sources which we want to measure with aperture photometry</p></li>
<li><p><strong>gain</strong> (<em>float</em><em>, </em><em>optional</em>) – Gain of observation in <span class="math notranslate nohighlight">\(e^{-}\ per\ ADU\)</span>, defaults to 1</p></li>
<li><p><strong>bkg_level</strong> (<em>float</em><em>, </em><em>optional</em>) – Number of standard deviations about the mean background below which was assume is due background fluctuations rather than any source flux , defaults to 3</p></li>
<li><p><strong>ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of aperture to be used as standard aperture size, defaults to 1.7</p></li>
<li><p><strong>inf_ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of aperture to be used as larger, <span class="math notranslate nohighlight">\(\mathit{infinite}\)</span> aperture size, defaults to 2.5</p></li>
<li><p><strong>r_in_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of aperture to be used as inner radius of background annulus, defaults to 1.9</p></li>
<li><p><strong>r_out_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of aperture to be used as outer radius of background annulus, defaults to 2.2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns the aperture sum, the error on the aperture sum, the max_pixel found within the aperture, the median value of the background and the standard deviation of the background.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.aperture.plot_aperture">
<span class="sig-prename descclassname"><span class="pre">packages.aperture.</span></span><span class="sig-name descname"><span class="pre">plot_aperture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">close_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_x_pix_corr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_y_pix_corr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_in_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_out_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.aperture.plot_aperture" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Package used for plotting close up of aperture photometry on point</p>
</div></blockquote>
<p>source. Package produces a cutout showing a closeup of a given target, the
aperture placement and size,and the annulus used for the sky background.
Additionally, projections along the X and Y plane are given to aid the User
in evaluating the aperture placement</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>close_up</strong> (<em>2D Array</em>) – 2D image containing target. Image does not need to be background subtracted</p></li>
<li><p><strong>target_x_pix_corr</strong> (<em>float</em>) – X Pixel coordinate of target within <span class="math notranslate nohighlight">\(close\_up\)</span> image.</p></li>
<li><p><strong>target_y_pix_corr</strong> (<em>float</em>) – y Pixel coordinate of target within <span class="math notranslate nohighlight">\(close\_up\)</span> image.</p></li>
<li><p><strong>fwhm</strong> (<em>float</em>) – Full Width Half Maximum of image. This is used to set the size for the apertures and annulli.</p></li>
<li><p><strong>ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of aperture to be used as standard aperture size, defaults to 1.7</p></li>
<li><p><strong>r_in_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of aperture to be used as inner radius of background annulus, defaults to 1.9</p></li>
<li><p><strong>r_out_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of aperture to be used as outer radius of background annulus, defaults to 2.2</p></li>
<li><p><strong>write_dir</strong> (<em>str</em>) – Directory where to place the image.</p></li>
<li><p><strong>base</strong> (<em>str</em>) – Name of file which is appended onto ‘<span class="math notranslate nohighlight">\(\mathit{target\_ap\_}\)</span>’.</p></li>
<li><p><strong>background_value</strong> (<em>float</em><em>, </em><em>optional</em>) – If given, plot the background value assumed for the image, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Produces a pdf plot of the target with an aperture and annuli. The file is saved to ‘<span class="math notranslate nohighlight">\(\mathit{write\_dir}\)</span>’ with the name ‘<span class="math notranslate nohighlight">\(\mathit{target\_ap\_}\)</span>’. + <span class="math notranslate nohighlight">\(\mathit{base}\)</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>PDF plot</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="packages-apply-airmass-extinction-module">
<h2>packages.apply_airmass_extinction module<a class="headerlink" href="#packages-apply-airmass-extinction-module" title="Permalink to this headline"></a></h2>
</div>
<div class="section" id="module-packages.call_astrometry_net">
<span id="packages-call-astrometry-net-module"></span><h2>packages.call_astrometry_net module<a class="headerlink" href="#module-packages.call_astrometry_net" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.call_astrometry_net.AstrometryNetLOCAL">
<span class="sig-prename descclassname"><span class="pre">packages.call_astrometry_net.</span></span><span class="sig-name descname"><span class="pre">AstrometryNetLOCAL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solve_field_exe_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpulimit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">180</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_astrometry_net.AstrometryNetLOCAL" title="Permalink to this definition"></a></dt>
<dd><p>Call a locally installed version of <a class="reference external" href="https://astrometry.net/use.html">Astrometry.net</a> to redo World Coordinates system (WCS)
values for a given image. Astrometry.net must be installed on your machine with
the correct index files for package to work sucessfully. Instructions on how do
do so may be found <a class="reference external" href="https://github.com/Astro-Sean/autophot">here</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – Filepath of <em>FITS</em> file which needs corrected WCS values</p></li>
<li><p><strong>solve_field_exe_loc</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Filepath location of the <em>solve-field</em> executable, see <a class="reference external" href="https://github.com/Astro-Sean/autophot">here</a> for instruction on how to find this path, defaults to None</p>
</p></li>
<li><p><strong>pixel_scale</strong> (<em>float</em><em>, </em><em>optional</em>) – Pixel scale in <span class="math notranslate nohighlight">\(arcseconds / pixel\)</span>. We recommend you include this variable as it can greatly speed up computation times and lower the risk of failures, defaults to None</p></li>
<li><p><strong>target_ra</strong> (<em>float</em><em>, </em><em>optional</em>) – Right ascension (RA) of target in degrees i.e. where are we looking on the sky. Telling Astrometry approximately where it is looking can greatly speed up computation times and lower the risk of failures , defaults to None</p></li>
<li><p><strong>target_dec</strong> (<em>float</em><em>, </em><em>optional</em>) – Declination ascension (RA) of target in degrees, defaults to None</p></li>
<li><p><strong>search_radius</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – Radius in degrees around target RA and Dec to search for correct location., defaults to 1</p></li>
<li><p><strong>downsample</strong> (<em>int</em><em>, </em><em>optional</em>) – For larger images it may be useful to downsample them to speed up computation times, defaults to 2</p></li>
<li><p><strong>cpulimit</strong> (<em>float</em><em>, </em><em>optional</em>) – Execution time limit in seconds for the local version of Astrometry.net. If the code run time exceeds this value, the script will exit, defaults to 180</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – If no output WCS file is created an excepted is raise</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns the filepath of the WCS file created from the image saved to the same parent directory as the image.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-packages.call_catalog">
<span id="packages-call-catalog-module"></span><h2>packages.call_catalog module<a class="headerlink" href="#module-packages.call_catalog" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.call_catalog.match">
<span class="sig-prename descclassname"><span class="pre">packages.call_catalog.</span></span><span class="sig-name descname"><span class="pre">match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headinfo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog_keywords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chosen_catalog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_x_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_y_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_dmag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_sources_XY_R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_moffat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_local_stars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_moff_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.765</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vary_moff_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkg_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sat_lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">65536</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_fit_fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_catalog_sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'least_squares'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matching_source_FWHM_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog_matching_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_IR_sequence_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pix_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_catalog_nondetections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_catalog.match" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Match sources in an image with sources given in a catalog. Sources location</p>
</div></blockquote>
<p>given in RA and Dec columns in a catalog are converted to XY pixel coordinates.
A cutout is then place on the approximate location and a source detection
algorithm is used. If there is a source detected at approximately the right
location this source and it’s magnitude measurements are saved, if not, the
source is removed.</p>
<p>Catalog sources can be excluded if they:</p>
<p>1. Are too close to an image boundary or are of the image entirely. If only
concerned with sources within a certain distance from the target, sources
outside this radius are excluded.</p>
<p>2. Are below a preselected magnitude limiting i.e. ignore all sources with a
catalog magnitude &gt; 21 mag.</p>
<ol class="arabic simple" start="3">
<li><p>If the source is too far away from it’s catalog position.</p></li>
<li><p>If a source is too close to the transient position.</p></li>
</ol>
<p>5. If there is no available data in the image filter, the source is
excluded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>2D array</em>) – Image containing stars</p></li>
<li><p><strong>headinfo</strong> (<em>Header</em>) – Header info of <em>FITS</em> image containing WCS information. This is used to translate catalog RA/Dec coordinates to XY pixel coordinates.</p></li>
<li><p><strong>target_coords</strong> (<em>SkyCoord Object</em>) – SkyCoord Object containing transient location</p></li>
<li><p><strong>catalog_keywords</strong> (<em>dict</em>) – Dictionary containing translation of catalog columns keywords to standard AutoPHOT system.</p></li>
<li><p><strong>image_filter</strong> (<em>str</em>) – Filter used in <em>FITS</em> image given in standard AutoPHOT system</p></li>
<li><p><strong>chosen_catalog</strong> (<em>dataFrame</em>) – DataFrame containing coordinates of stars with headers <em>x_pix</em> and <em>y_pix</em>.</p></li>
<li><p><strong>fwhm</strong> (<em>float</em>) – Full Width Half Maximum of image</p></li>
<li><p><strong>local_radius</strong> (<em>float</em><em>, </em><em>optional</em>) – Pixel radius around target to look for sources, defaults to 1000</p></li>
<li><p><strong>target_x_pix</strong> (<em>float</em><em>, </em><em>optional</em>) – Approximate X pixel location of transient, defaults to None</p></li>
<li><p><strong>target_y_pix</strong> (<em>float</em><em>, </em><em>optional</em>) – Approximate y pixel location of transient,, defaults to None</p></li>
<li><p><strong>default_dmag</strong> (<em>dict</em><em>, </em><em>optional</em>) – Filter combinations for color correction, defaults to None</p></li>
<li><p><strong>mask_sources_XY_R</strong> (<em>List of Tuples</em><em>, </em><em>optional</em>) – List of tuples containing sources to be masked in formation [(x_pix,y_pix,radius)], defaults to None</p></li>
<li><p><strong>use_moffat</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use moffat function for centroiding, defaults to True</p></li>
<li><p><strong>default_moff_beta</strong> (<em>float</em><em>, </em><em>optional</em>) – Default exponent for moffat function,  defaults to 4.765</p></li>
<li><p><strong>use_local_stars</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use local stars within a radius set by <em>local_radius</em>, defaults to False</p></li>
<li><p><strong>vary_moff_beta</strong> (<em>Bool</em><em>, </em><em>optional</em>) – If True, allow the exponent of the moffat function to vary. use with Caution as this may become unstable, defaults to False</p></li>
<li><p><strong>bkg_level</strong> (<em>float</em><em>, </em><em>optional</em>) – The number of standard deviations to use for both the lower and upper clipping limit for background determination, defaults to 3</p></li>
<li><p><strong>scale</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary containing values for model fitting. If Gaussian is used. the variable should containg <em>sigma</em> and if moffat used, this variable should contain <em>beta</em> and <em>alpha</em>, defaults to 25</p></li>
<li><p><strong>sat_lvl</strong> (<em>float</em><em>, </em><em>optional</em>) – Counts level above which a source is deemed saturation and ignored, defaults to 65536</p></li>
<li><p><strong>max_fit_fwhm</strong> (<em>float</em><em>, </em><em>optional</em>) – Max value to fit for the FWHM, defaults to 30</p></li>
<li><p><strong>max_catalog_sources</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of catalog sources to use, defaults to 300</p></li>
<li><p><strong>fitting_method</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Selected method to fit model for centroid. Select from list given <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html">here</a> , defaults to ‘least_squares’</p>
</p></li>
<li><p><strong>matching_source_FWHM_limit</strong> (<em>float</em><em>, </em><em>optional</em>) – Excluded sources whose FWHM is greater than this value, defaults to np.inf</p></li>
<li><p><strong>catalog_matching_limit</strong> (<em>float</em><em>, </em><em>optional</em>) – Exclude sources that are fainter than this limit in magnitudes, defaults to 25</p></li>
<li><p><strong>include_IR_sequence_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, add IR data to output catalog, defaults to False</p></li>
<li><p><strong>pix_bound</strong> (<em>float</em><em>, </em><em>optional</em>) – Remove sources that are too close to boundary of image. Distance to boundary is given by this variable in pixels, defaults to 25</p></li>
<li><p><strong>plot_catalog_nondetections</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return a plot of catalog sources that were not detected, defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>returns a new dataframe containing useable sources in the image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.call_catalog.search">
<span class="sig-prename descclassname"><span class="pre">packages.call_catalog.</span></span><span class="sig-name descname"><span class="pre">search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headinfo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog_keywords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'apass'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_IR_sequence_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog_custom_fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_catalog.search" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Search for sequence stars for zero point calibration. This function takes in</p>
</div></blockquote>
<p>the target location are searches for photometric data on stars near this
location. The available catalogs are:</p>
<p>1. <a class="reference external" href="https://www.aavso.org/apass">APASS:</a> - The AAVSO Photometric All-Sky
Survey</p>
<p>Covers eight filters: Johnson B and V, plus Sloan u’, g′, r′, i′, <span class="math notranslate nohighlight">\(z_s\)</span>
and Z. It is valid from about 7th magnitude to about 17th magnitude and covers
-10.15 &lt; Dec &lt; +87.35.</p>
<p>Keyword = <span class="math notranslate nohighlight">\(&quot;apass&quot;\)</span></p>
<ol class="arabic simple" start="2">
<li><p><a class="reference external" href="https://www.sdss.org/">SDSS</a> - Sloan Digital Sky Survey.</p></li>
</ol>
<p>Cover 5 filters, SDSS r, i, u, z, and g filters and is valid down to ~22
mag.</p>
<p>Keyword = <span class="math notranslate nohighlight">\(&quot;sdss&quot;\)</span></p>
<p>3. <a class="reference external" href="https://panstarrs.stsci.edu/">Panstarrs</a> - Panoramic Survey Telescope
an.d Rapid Response System</p>
<p>Cover 5 filters, covers 5 filters, g, r, i, z, and y and is valid down to ~24
mag. Panstarrs covers all the sky north of declination −47.5.</p>
<p>Keyword = <span class="math notranslate nohighlight">\(&quot;pan\_starrs&quot;\)</span></p>
<p>4. <a class="reference external" href="https://irsa.ipac.caltech.edu/Missions/2mass.html">2MASS</a> Two Micron All
Sky Survey.</p>
<p>Cover 3 filters, the NIR J, H, and K bands with a limiting magnitude of K~13mag
(Vega) and covers all the sky.</p>
<p>Keyword = <span class="math notranslate nohighlight">\(&quot;2mass&quot;\)</span></p>
<p>5. <a class="reference external" href="https://github.com/Astro-Sean/autophot/blob/master/example_notebooks/add_your_catalog_example.ipynb">Custom</a></p>
<p>You may also pass a custom catalog to this script. This catalog must contain
<em>RA</em> and <em>DEC</em> columns (case sensitive), as well as filters magnitudes and
their error in the standard AutoPHOT system. If given you must include the
<em>catalog_custom_fpath</em> keyword which gives the file path to this file. An
example of this can be found <a class="reference external" href="https://github.com/Astro-Sean/autophot/blob/master/example_notebooks/add_your_catalog_example.ipynb">here</a></p>
<p>Keyword = <span class="math notranslate nohighlight">\(&quot;custom&quot;\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>headinfo</strong> (<em>Fits Header</em>) – Headerinfo of <em>FITS</em> image that contains WCS values</p></li>
<li><p><strong>target_coords</strong> (<em>SkyCoord Object</em>) – <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html">SkyCoord Object</a> conataing Ra and Dec of transient. This is used to position the catalog search.</p></li>
<li><p><strong>catalog_keywords</strong> (<em>Dict</em>) – Dictionary containing translation of catalog columns keywords to standard AutoPHOT system.</p></li>
<li><p><strong>image_filter</strong> (<em>str</em>) – Filter used in <em>FITS</em> image</p></li>
<li><p><strong>radius</strong> (<em>float</em><em>, </em><em>optional</em>) – Radius in degrees around target location with which to download catalog, defaults to 0.5</p></li>
<li><p><strong>wdir</strong> (Location of directory containing catalog queries. If no matching catalog is found, downloaded catalog is saved here under the name given by <em>target_name</em>, if a matching catalog is found that catalog is returned rather than downloading a new one.) – DESCRIPTION, defaults to None</p></li>
<li><p><strong>catalog</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of catalog to search, see keywords above, defaults to ‘apass’</p></li>
<li><p><strong>target_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of transient. This is used to locate the correct folder in <em>wdir</em> to download new catalog to, defaults to None</p></li>
<li><p><strong>include_IR_sequence_data</strong> (bool, optional &lt;<a class="reference external" href="https://github.com/Astro-Sean/autophot/blob/master/example_notebooks/add_your_catalog_example.ipynb">https://github.com/Astro-Sean/autophot/blob/master/example_notebooks/add_your_catalog_example.ipynb</a>&gt;`_ for an example, defaults to None) – If True, and catalog is not 2MASS return a catalog with optical observations as well as IR observations. This can be useful if you have a dataset containing Optical and IR observations (e.g. from GROND) and don’t want to run AutoPHOT multiple times with different catalogs selected., defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – If no data is found, an error is raised</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns the catalog information</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dataframe</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-packages.call_crayremoval">
<span id="packages-call-crayremoval-module"></span><h2>packages.call_crayremoval module<a class="headerlink" href="#module-packages.call_crayremoval" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.call_crayremoval.remove_cosmic_rays">
<span class="sig-prename descclassname"><span class="pre">packages.call_crayremoval.</span></span><span class="sig-name descname"><span class="pre">remove_cosmic_rays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_with_CRs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lacosmic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_crayremoval.remove_cosmic_rays" title="Permalink to this definition"></a></dt>
<dd><p>Function to remove Cosmic Rays from an image. Cosmic Rays (CRs) are high energy
particles that impact the CCD detector and can result in bright points or
streaks on the CCD image. For images with long exposure times, CRs can be
problematic as they may lie on top of regions or sources of interest This
fucntion can using either <a class="reference external" href="https://astroscrappy.readthedocs.io/en/latest/#functions">Astroscrappy</a> or <a class="reference external" href="https://ccdproc.readthedocs.io/en/latest/api/ccdproc.cosmicray_lacosmic.html">LACosmic</a>
and returns an image cleaned of cosmic rays</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_with_CRs</strong> (<em>str</em>) – File Path to <em>fits</em> image that is contaminated by cosmic rays.</p></li>
<li><p><strong>gain</strong> (<em>float</em><em>, </em><em>optional</em>) – Gain of the image (electrons / ADU). We always need to work in electrons for cosmic ray detection., defaults to 1</p></li>
<li><p><strong>use_lacosmic</strong> (<em>boolean</em><em>, </em><em>optional</em>) – If True, use LAComic from CCDProc rather that astroscrappy, defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns an image that has been cleaned of cosmic rays</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-packages.call_datacheck">
<span id="packages-call-datacheck-module"></span><h2>packages.call_datacheck module<a class="headerlink" href="#module-packages.call_datacheck" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.call_datacheck.ask_for_keyword">
<span class="sig-prename descclassname"><span class="pre">packages.call_datacheck.</span></span><span class="sig-name descname"><span class="pre">ask_for_keyword</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_datacheck.ask_for_keyword" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.call_datacheck.ask_question">
<span class="sig-prename descclassname"><span class="pre">packages.call_datacheck.</span></span><span class="sig-name descname"><span class="pre">ask_question</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">question</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_answer='n'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expect_answer_type=&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_type=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_word='skip'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_datacheck.ask_question" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>question</strong> (<em>TYPE</em>) – DESCRIPTION</p></li>
<li><p><strong>default_answer</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION, defaults to ‘n’</p></li>
<li><p><strong>expect_answer_type</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION, defaults to str</p></li>
<li><p><strong>options</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION, defaults to None</p></li>
<li><p><strong>ignore_type</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION, defaults to False</p></li>
<li><p><strong>ignore_word</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION, defaults to ‘skip’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DESCRIPTION</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.call_datacheck.checkteledata">
<span class="sig-prename descclassname"><span class="pre">packages.call_datacheck.</span></span><span class="sig-name descname"><span class="pre">checkteledata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autophot_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_datacheck.checkteledata" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>autophot_input</strong> (<em>TYPE</em>) – DESCRIPTION</p></li>
<li><p><strong>flst</strong> (<em>TYPE</em>) – DESCRIPTION</p></li>
<li><p><strong>filepath</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DESCRIPTION</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.call_datacheck.find_similar_words">
<span class="sig-prename descclassname"><span class="pre">packages.call_datacheck.</span></span><span class="sig-name descname"><span class="pre">find_similar_words</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">words</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_words</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_datacheck.find_similar_words" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>words</strong> (<em>TYPE</em>) – DESCRIPTION</p></li>
<li><p><strong>search_words</strong> (<em>TYPE</em>) – DESCRIPTION</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DESCRIPTION</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="packages-call-hotpants-module">
<h2>packages.call_hotpants module<a class="headerlink" href="#packages-call-hotpants-module" title="Permalink to this headline"></a></h2>
</div>
<div class="section" id="packages-call-locationcheck-module">
<h2>packages.call_locationcheck module<a class="headerlink" href="#packages-call-locationcheck-module" title="Permalink to this headline"></a></h2>
</div>
<div class="section" id="module-packages.call_yaml">
<span id="packages-call-yaml-module"></span><h2>packages.call_yaml module<a class="headerlink" href="#module-packages.call_yaml" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="packages.call_yaml.yaml_autophot_input">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">packages.call_yaml.</span></span><span class="sig-name descname"><span class="pre">yaml_autophot_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_yaml.yaml_autophot_input" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="packages.call_yaml.yaml_autophot_input.create_yaml">
<span class="sig-name descname"><span class="pre">create_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_yaml.yaml_autophot_input.create_yaml" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="packages.call_yaml.yaml_autophot_input.load_vars">
<span class="sig-name descname"><span class="pre">load_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_yaml.yaml_autophot_input.load_vars" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="packages.call_yaml.yaml_autophot_input.update_var">
<span class="sig-name descname"><span class="pre">update_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tele</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inst_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.call_yaml.yaml_autophot_input.update_var" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-packages.check_tns">
<span id="packages-check-tns-module"></span><h2>packages.check_tns module<a class="headerlink" href="#module-packages.check_tns" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.check_tns.format_to_json">
<span class="sig-prename descclassname"><span class="pre">packages.check_tns.</span></span><span class="sig-name descname"><span class="pre">format_to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.check_tns.format_to_json" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.check_tns.get_coords">
<span class="sig-prename descclassname"><span class="pre">packages.check_tns.</span></span><span class="sig-name descname"><span class="pre">get_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TNS_BOT_ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TNS_BOT_NAME</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TNS_BOT_API</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.check_tns.get_coords" title="Permalink to this definition"></a></dt>
<dd><p>Function to access the <a class="reference external" href="https://www.wis-tns.org/">Transient Name Server</a>
(TNS) to obtain the most up-to-date position coordinates of a given taken. To
use this function you must have access to a TNS bot and have the required
information (<em>Bot Name</em>, <em>Bot ID</em>, and <em>Bot API</em>).</p>
<p><a class="reference external" href="https://www.wis-tns.org/content/tns-getting-started">Credit: Nikola Knezevic</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>objname</strong> (<em>Str</em>) – Name of the tranisnet in the International Astronomical Union (IAU) format .e.g 1987A, 2009ip, NOT SN1987A. Errors will arise if non-standard names are used e.g. OGLE123</p></li>
<li><p><strong>TNS_BOT_ID</strong> (<em>float</em><em>, </em><em>optional</em>) – Identification code of your BOT, defaults to None</p></li>
<li><p><strong>TNS_BOT_NAME</strong> (<em>str</em><em>, </em><em>optional</em>) – Identification name of your BOT, defaults to None</p></li>
<li><p><strong>TNS_BOT_API</strong> (<em>str</em><em>, </em><em>optional</em>) – API code for your BOT, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a dictionary containing information on the desired transientwhich includes latest coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-packages.check_wcs">
<span id="packages-check-wcs-module"></span><h2>packages.check_wcs module<a class="headerlink" href="#module-packages.check_wcs" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.check_wcs.removewcs">
<span class="sig-prename descclassname"><span class="pre">packages.check_wcs.</span></span><span class="sig-name descname"><span class="pre">removewcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.check_wcs.removewcs" title="Permalink to this definition"></a></dt>
<dd><p>Function to erase all World Coordinate System (WCS) keywords from a fits
header. Values are deleted/adjusted if the fall into the list below:</p>
<p><em>CD1_1</em>, <em>CD1_2</em>, <em>CD2_1</em>, <em>CD2_2</em>, <em>CRVAL1</em>, <em>CRVAL2</em>, <em>CRPIX1</em>, <em>CRPIX2</em>,
<em>CUNIT1</em>, <em>CUNIT2</em>, <em>CTYPE1</em>, <em>CTYPE2</em>, <em>WCSAXES</em>, <em>EQUINOX</em>, <em>LONPOLE</em>,
<em>LATPOLE</em>, <em>CDELT1</em>, <em>CDELT2</em>, <em>A_ORDER</em>, <em>A_0_0</em>, <em>A_0_1</em>, <em>A_0_2</em>, <em>A_1_0</em>,
<em>A_1_1</em>, <em>A_2_0</em>, <em>B_ORDER</em>, <em>B_0_0</em>, <em>B_0_1</em>, <em>B_0_2</em>, <em>B_1_0</em>, <em>B_1_1</em>,
<em>B_2_0</em>, <em>AP_ORDER</em>, <em>AP_0_0</em>, <em>AP_0_1</em>, <em>AP_0_2</em>, <em>AP_1_0</em>, <em>AP_1_1</em>,
<em>AP_2_0</em>, <em>BP_ORDER</em>, <em>BP_0_0</em>, <em>BP_0_1</em>, <em>BP_0_2</em>, <em>BP_1_0</em>, <em>BP_1_1</em>,
<em>BP_2_0</em>, <em>PROJP1</em>, <em>PROJP3</em>, <em>RADECSYS</em>, <em>PV1_1</em>, <em>PV1_2</em>, <em>PV2_1</em>, <em>PV2_2</em>,
<em>LTV1</em>, <em>LTV2</em>, <em>LTM1_1</em>, <em>LTM2_2</em>, <em>PC1_1</em>, <em>PC1_2</em>, <em>PC2_1</em>, <em>PC2_2</em>,
<em>RADESYS</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent_header</strong> (<em>FITS</em> Header object) – Header object containing WCS information which we want to erase</p></li>
<li><p><strong>delete_keys</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, delete these keys, else concatenate “<em>_</em>” onto them, defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Corrected header file will corrected/deleted WCS keys</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><em>FITS</em> Header object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.check_wcs.updatewcs">
<span class="sig-prename descclassname"><span class="pre">packages.check_wcs.</span></span><span class="sig-name descname"><span class="pre">updatewcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs_fits</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.check_wcs.updatewcs" title="Permalink to this definition"></a></dt>
<dd><p>Update <em>parent_header</em> with WCS keys from <em>wcs_fits</em> header</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent_header</strong> (<em>Header Object</em>) – Header file with outdated or missing WCS keywords and  values</p></li>
<li><p><strong>wcs_fits</strong> (<em>Header Object</em>) – Header file with corrected WCS keywords and values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Parent Header with Updated WCS keywords</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Header Object</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="packages-color-correction-module">
<h2>packages.color_correction module<a class="headerlink" href="#packages-color-correction-module" title="Permalink to this headline"></a></h2>
</div>
<div class="section" id="module-packages.create_plots">
<span id="packages-create-plots-module"></span><h2>packages.create_plots module<a class="headerlink" href="#module-packages.create_plots" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.create_plots.plot_PSF_model_steps">
<span class="sig-prename descclassname"><span class="pre">packages.create_plots.</span></span><span class="sig-name descname"><span class="pre">plot_PSF_model_steps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sources_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autophot_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.create_plots.plot_PSF_model_steps" title="Permalink to this definition"></a></dt>
<dd><p>Plot out steps for PSF model for use in publication</p>
</dd></dl>

</div>
<div class="section" id="module-packages.find">
<span id="packages-find-module"></span><h2>packages.find module<a class="headerlink" href="#module-packages.find" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.find.combine">
<span class="sig-prename descclassname"><span class="pre">packages.find.</span></span><span class="sig-name descname"><span class="pre">combine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionaries</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.find.combine" title="Permalink to this definition"></a></dt>
<dd><p>Combine list of dictionaies</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dictionaries</strong> (<em>Dict</em>) – List of dictionaries</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Combined dictionary with values equal to a list of original dictionary values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.find.create_circular_mask">
<span class="sig-prename descclassname"><span class="pre">packages.find.</span></span><span class="sig-name descname"><span class="pre">create_circular_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.find.create_circular_mask" title="Permalink to this definition"></a></dt>
<dd><p>Create mask centered within a image with height <em>h</em> and width <em>w</em> centered on
<em>center</em> with a radius <em>radius</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h</strong> (<em>int</em>) – height of image</p></li>
<li><p><strong>w</strong> (<em>int</em>) – width of image</p></li>
<li><p><strong>center</strong> (<em>tuple with x</em><em>, </em><em>y pixel position</em><em>, </em><em>optional</em>) – pixel location of mask, if none, mask out center of image defaults to None</p></li>
<li><p><strong>radius</strong> (<em>float</em><em>, </em><em>optional</em>) – radius of mask in pixels, if none, use the smallest distance between the center and image walls defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image with shape h,w with masked regions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array with height <em>h</em> and width <em>w</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.find.get_fwhm">
<span class="sig-prename descclassname"><span class="pre">packages.find.</span></span><span class="sig-name descname"><span class="pre">get_fwhm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkg_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_source_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_source_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fudge_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fine_fudge_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sat_lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">65536</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_threshold_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_multipler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaclip_FWHM_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaclip_median_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isolate_sources_fwhm_sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_iso_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pix_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_FWHM_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_analysis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_local_stars_for_FWHM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_templates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vary_moff_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_moff_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.765</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_fit_fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'least_square'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_sources_XY_R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_sat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_moffat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_x_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_y_pix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_catalog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.find.get_fwhm" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Robust function to find FWHM in an image.</p>
</div></blockquote>
<p>The Full Width Half Maximum (FWHM) of point sources in an image is determined
by the astronomical seeing when the image was taken, as well as the telescope
and instrument optics.</p>
<p>AutoPHOT needs to adapt to the number of point sources in an images. A deep
image with a large field of view (FoV) will have considerably more sources than
a shallow image with a small FoV. Too few sources may lead to poorly sampled
(or incorrect) values of the FWHM, while too many sources may indicate the
detection threshold is too low (i.e. background noise is detected as a source)
and needlessly increases the computation time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>2D array</em>) – Image containing sources</p></li>
<li><p><strong>wdir</strong> (<em>str</em>) – File Path location for where to save plots and tables</p></li>
<li><p><strong>base</strong> (<em>str</em>) – Name of file to distinctly label plots and tables</p></li>
<li><p><strong>threshold_value</strong> (<em>float</em><em>, </em><em>optional</em>) – Initial threshold value for which to search for sources. The detection criteria is initial set to look for sources <span class="math notranslate nohighlight">\(threshold\_value  imes \sigma_{bkg}\)</span> where:math:<cite>sigma_{bkg}</cite> is the standard deviation of the image. This value is updated during execution , defaults to 25</p></li>
<li><p><strong>fwhm_guess</strong> (<em>float</em><em>, </em><em>optional</em>) – initial guess for the FWHM, this is updated once any source are found, defaults to 5</p></li>
<li><p><strong>bkg_level</strong> (<em>float</em><em>, </em><em>optional</em>) – The number of standard deviations to use for both the lower and upper clipping limit when determining the background level,  defaults to 3</p></li>
<li><p><strong>max_source_lim</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of sources to search for. If more sources are found, increase threshold value, defaults to 1000</p></li>
<li><p><strong>min_source_lim</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum amount of sources to search for. If less than this value are found, an error is raise, defaults to 2</p></li>
<li><p><strong>int_scale</strong> (<em>int</em><em>, </em><em>optional</em>) – Initial size of the cutout to place around sources. This value is updated, defaults to 25</p></li>
<li><p><strong>fudge_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – Large step size when increasing/decreasing the:math:<cite>threshold_value</cite>, defaults to 5</p></li>
<li><p><strong>fine_fudge_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – If the code runs into an issue when there is too large of a change in sources detected per step size, we assumed that we are now detecting background noise. In this case we switch to this value and change the <span class="math notranslate nohighlight">\(threshold\_value\)</span>, by a small increment. This is also used if the <span class="math notranslate nohighlight">\(threshold\_value\)</span> drops below <span class="math notranslate nohighlight">\(5\sigma_bkg\)</span> defaults to 0.1</p></li>
<li><p><strong>source_max_iter</strong> (<em>Init</em><em>, </em><em>optional</em>) – Backstop to inhibit the source detection algorithm to execute for too long. The code my take a long time if initial too many sources are found and you start of with too long of an initial <span class="math notranslate nohighlight">\(threshold\_value\)</span>, or if it cannot find any sources about the background level defaults to 50</p></li>
<li><p><strong>sat_lvl</strong> (<em>float</em><em>, </em><em>optional</em>) – Counts level above which any detected source is deemed saturated and discarded, defaults to 65536</p></li>
<li><p><strong>lim_theshold_value</strong> (<em>float</em><em>, </em><em>optional</em>) – If the threshold_value decreases below this value, use <span class="math notranslate nohighlight">\(fine\_fudge\_factor\)</span>, defaults to 5</p></li>
<li><p><strong>scale_multipler</strong> (<em>int</em><em>, </em><em>optional</em>) – Integer times the FWHM used when creating the new cutout size, defaults to 4</p></li>
<li><p><strong>sigmaclip_FWHM_sigma</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION, defaults to 3</p></li>
<li><p><strong>sigmaclip_median_sigma</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION, defaults to 3</p></li>
<li><p><strong>isolate_sources_fwhm_sep</strong> (<em>float</em><em>, </em><em>optional</em>) – Isolate detected sources by this amount times the FWHM, defaults to 5</p></li>
<li><p><strong>init_iso_scale</strong> (<em>float</em><em>, </em><em>optional</em>) – Initial distance to isolated detected sources by, defaults to 25</p></li>
<li><p><strong>pix_bound</strong> (<em>float</em><em>, </em><em>optional</em>) – Ignore sources near the edge of the image. Value given in pixels, defaults to 25</p></li>
<li><p><strong>save_FWHM_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, plot a distribution of the FWHM values, defaults to False</p></li>
<li><p><strong>image_analysis</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, plot a distribution of the FWHM values across the image and save this information as a <em>csv</em> file, defaults to False</p></li>
<li><p><strong>use_local_stars_for_FWHM</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use stars within <a href="#id5"><span class="problematic" id="id6">*</span></a>local_radius pixels to determine the FWHM. This is useful if there is a spread of FWHM values across the image, defaults to False</p></li>
<li><p><strong>prepare_templates</strong> (<em>bool</em><em>, </em><em>optional</em>) – IF True, preform FWHM measurements on template image, defaults to False</p></li>
<li><p><strong>fitting_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Fitting method when measuring the FWHM, defaults to ‘least_square’</p></li>
<li><p><strong>local_radius</strong> (<em>float</em><em>, </em><em>optional</em>) – Distance from target location to search for stars and find FWHM value, defaults to 1000</p></li>
<li><p><strong>mask_sources_XY_R</strong> (<em>List of Tuples</em><em>, </em><em>optional</em>) – List of tuples containing sources to be masked in formation [(x_pix,y_pix,radius)], defaults to None</p></li>
<li><p><strong>remove_sat</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, remove sources that have a maximum brightness greater than <em>sat_lvl</em>, defaults to True</p></li>
<li><p><strong>use_moffat</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use a moffat function for FWHM fitting defaults to</p></li>
<li><p><strong>default_moff_beta</strong> (<em>float</em><em>, </em><em>optional</em>) – Default value for the Moffat function exponent, defaults to 4.765</p></li>
<li><p><strong>vary_moff_beta</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, allowing the <span class="math notranslate nohighlight">\(eta\)</span> exponent in the Moffat function to vary. This may become unstable, defaults to False</p></li>
<li><p><strong>max_fit_fwhm</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum FWHM allowed when fitting analytical function, defaults to 30</p></li>
<li><p><strong>target_x_pix</strong> (<em>float</em><em>, </em><em>optional</em>) – X pixel coordinate of target. If given, exclude the general location of the target when fitting for the FWHM defaults to None</p></li>
<li><p><strong>target_y_pix</strong> (<em>float</em><em>, </em><em>optional</em>) – Y pixel coordinate of target.If given, exclude the general location of the target when fitting for the FWHM, defaults to None</p></li>
<li><p><strong>scale</strong> (<em>int</em><em>, </em><em>optional</em>) – If known, preset the cutout size to this value. Cutout size = (<span class="math notranslate nohighlight">\(2       imes scale\)</span>, <span class="math notranslate nohighlight">\(2   imes scale\)</span>), defaults to None</p></li>
<li><p><strong>use_catalog</strong> (<em>str</em><em>, </em><em>optional</em>) – If True, use a catalog containing the columns <em>x_pix</em> and <em>y_pix</em> instead of using source detection. This variable source correspond tothe filepath of the catalog <em>csv</em> file, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns the image FWHM, a dataframe containing information on thefitted sources, the updated cutout scale and the <span class="math notranslate nohighlight">\(image\_params\)</span> dictionary containing information on the best fitting analytical model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List of objects</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-packages.functions">
<span id="packages-functions-module"></span><h2>packages.functions module<a class="headerlink" href="#module-packages.functions" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.SNR">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">SNR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux_star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_sky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DC</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.SNR" title="Permalink to this definition"></a></dt>
<dd><p>Compute the signal to noise ratio (S/N) equation taken from <a class="reference external" href="https://www.ucolick.org/~bolte/AY257/s_n.pdf">here</a>.</p>
<div class="math notranslate nohighlight">
\[S/N = \frac{ F_{ap} }{ F_{ap} + F_{sky,ap,n} + (RN ^2 + \frac{G^2}{4} \times n_{pix}) + (D \times n_{pix} \times t_{exp}) } ^{0.5}\]</div>
<p>where <span class="math notranslate nohighlight">\(F_{ap}\)</span> is the flux under and aperture of a specific radius, and likewise <span class="math notranslate nohighlight">\(F_{sky,ap,n}\)</span> is the flux due to the sky background under the same aperture. In other words <span class="math notranslate nohighlight">\(F_{sky,ap,n} = \langle counts_{sky_ap}  \rangle / T_{exp} \times n\)</span> where <span class="math notranslate nohighlight">\(n = \pi r ^2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux_star</strong> (<em>float</em>) – Flux in <span class="math notranslate nohighlight">\(counts / second\)</span> that we assume is coming from source.</p></li>
<li><p><strong>flux_sky</strong> (<em>float</em>) – Flux in <span class="math notranslate nohighlight">\(mean\ counts /  second / pixel\)</span> that we assume is coming from sky background.</p></li>
<li><p><strong>exp_t</strong> (<em>float</em>) – Exposure time in seconds.</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – Radius of aperture in pixels.</p></li>
<li><p><strong>G</strong> (<em>float</em><em>, </em><em>optional</em>) – GAIN on CCD in <span class="math notranslate nohighlight">\(e^{-1} /  ADU\)</span> , defaults to 1.</p></li>
<li><p><strong>RN</strong> (<em>float</em><em>, </em><em>optional</em>) – Read noise of CCD in <span class="math notranslate nohighlight">\(e^{-1} /  pixel\)</span>, defaults to 0.</p></li>
<li><p><strong>DC</strong> (<em>float</em><em>, </em><em>optional</em>) – Dark Current of CCD in <span class="math notranslate nohighlight">\(e^{-1} /  pixel  /  second\)</span>, defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Signal to noise of given source</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.SNR_err">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">SNR_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SNR</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.SNR_err" title="Permalink to this definition"></a></dt>
<dd><p>Error associated with signal to noise ratio (S/N). Equation  taken from <a class="reference external" href="https://www.ucolick.org/~bolte/AY257/s_n.pdf">here</a>. Where can associated the error on the instrumental magnitude of a source as:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}m \pm \delta m = -2.5 \times log_{10} ( S \pm N) \\\rightarrow = -2.5 \times log_{10} ( S  (1 \pm N / S ) )\\\rightarrow = -2.5 \times log_{10} ( S )   -2.5 \times log_{10}(1 \pm N / S ) )\\\delta m = \mp 2.5\times log_{10} (1 + \frac{1}{S/N}) \approx \mp 1.0875 (N / S})\end{aligned}\end{align} \]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>SNR</strong> (<em>float</em>) – Signal to noise ratio of a point-like source.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Error associated with that source’s S / N</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.arcmins2pixel">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">arcmins2pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.arcmins2pixel" title="Permalink to this definition"></a></dt>
<dd><p>Convert distance given in Arc minutes to distance in linear pixel coordinates  using the following equation:</p>
<div class="math notranslate nohighlight">
\[pixels = 60/3600  \times pixel\_scale \times arcmins\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>float</em>) – linear distance in arcmins</p></li>
<li><p><strong>pixel_scale</strong> (<em>float</em>) – Pixel scale of image in degrees. This is typically the output format when using Astropy’s <span class="math notranslate nohighlight">\(wcs.utils.proj\_plane\_pixel\_scales(w)\)</span> function, where <span class="math notranslate nohighlight">\(w\)</span> is an images WCS object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>linear distance in pixels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.array_correction">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">array_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.array_correction" title="Permalink to this definition"></a></dt>
<dd><p>Correct the float nature of pixel position used in numpy. If a pixel position 
is more than halfway accros a pixel roundup, else round down.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>float</em>) – pixel position</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>corrected position</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.beta_value">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">beta_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_ul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.beta_value" title="Permalink to this definition"></a></dt>
<dd><p>False negatives function for the fraction of real sources that go undetected. This is implemented in AutoPHOT to determine whether a source,  more specifically it’s flux, can be confidently assumed to arise from the source and not be associated with the background noise distribution. We describe the probability that a suspected source can be confidently assumed to be seperate from the flux due to the background by:</p>
<div class="math notranslate nohighlight">
\[1 - \beta = \beta{\prime} = \frac{1}{2}(1 - \mathit{erf} \frac{n\sigma_{bkg} - f_{source}}{\sigma_{bkg} \sqrt{2}})\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta{\prime}\)</span> is the confident that source is not apart of the underlying noise distribution, <span class="math notranslate nohighlight">\(\mathit{erf}\)</span> is the <a class="reference external" href="https://mathworld.wolfram.com/Erf.html">Error function</a>, <span class="math notranslate nohighlight">\(f_{source}\)</span> is the brightest pixel that can be associated with a source, and <span class="math notranslate nohighlight">\(\sigma_{bkg}\)</span> is the standard deviation of the background noise distribution.</p>
<p>In other words, <span class="math notranslate nohighlight">\(100\times (1-\beta) \%\)</span> of the
sources with flux <span class="math notranslate nohighlight">\(f_{source}\)</span> will have flux measurements &gt; <span class="math notranslate nohighlight">\(n\sigma_{bkg}\)</span></p>
<p>Credit: <a class="reference external" href="http://web.ipac.caltech.edu/staff/fmasci/home/mystats/UpperLimits_FM2011.pdf">F. Masci</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>float</em>) – Level above background to be considered a genuine detection. Typical values are <span class="math notranslate nohighlight">\(n = 3\)</span>, which equations to a <span class="math notranslate nohighlight">\(3\sigma\)</span> confidence level, or in other words there is a 0.135% probability that the measured flux is a spurious noise spike.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – Background standard deviation.</p></li>
<li><p><strong>f_ul</strong> (<em>float</em>) – Brightest pixel value that can be associated with a suspected source.</p></li>
</ul>
</dd>
</dl>
<p>:param noise Mean offset of flux measurement. This value should be included if the measurement of the source is not background subtracted, defaults to 0
:type noise: float, optional
:return: False negatives probability which describes the confidence to which a source can be consider real and not be associated with a spurious noise spike.
:rtype: float</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.border_msg">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">border_msg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'+'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.border_msg" title="Permalink to this definition"></a></dt>
<dd><p>Produce a print statement where the text is surrounded by a box. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>&gt; border_msg(&#39;Hello There&#39;)
&gt; +-----------+ 
  |Hello There|
  +-----------+

&gt; border_msg(&#39;General Kenobi&#39;,body = &#39;=&#39;,corner = &#39;!&#39;)
&gt; !==============!
  |General Kenobi|
  !==============!
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – String message which will be printed to screen.</p></li>
<li><p><strong>body</strong> (<em>str</em><em>, </em><em>optional</em>) – String character to represent body around message, defaults to ‘-‘</p></li>
<li><p><strong>corner</strong> (<em>trs</em><em>, </em><em>optional</em>) – String character to represent the four corners around message, defaults to ‘+’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Original string with borner around it.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Print statement</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.calc_mag">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">calc_mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.calc_mag" title="Permalink to this definition"></a></dt>
<dd><p>Calculate magnitude of apoint source</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<em>array</em>) – Flux in counts per second measured from source</p></li>
<li><p><strong>zp</strong> (<em>array</em>) – Zeropoint to place measurement on standard system</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Magnitude of source on standard system</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.calc_mag_error">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">calc_mag_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.calc_mag_error" title="Permalink to this definition"></a></dt>
<dd><p>Calculate magnitude error due to noise on flux measurement. 
Magnitude error is given by:</p>
<div class="math notranslate nohighlight">
\[\delta m = \pm 2.5Log_{10}(1 + \frac{1}{S/N}) \approx 1.0857 \times N/S\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<em>float</em>) – Flux measurement</p></li>
<li><p><strong>noise</strong> (<em>float</em>) – Error on flux measurement</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Magnitude error due to noise on flux measurement</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.error_log">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">error_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.error_log" title="Permalink to this definition"></a></dt>
<dd><p>Calculate relative error on value which is displayed in log form</p>
<p>Credit: <a class="reference external" href="https://faculty.washington.edu/stuve/log_error.pdf">Here</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>float</em>) – Value with associated error</p></li>
<li><p><strong>error</strong> (<em>float</em>) – Error associated with value</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Error in log form</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.f_ul">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">f_ul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.f_ul" title="Permalink to this definition"></a></dt>
<dd><p>Flux upper limit for an environment with a Gaussian like noise distribution. This value represents the flux required, above which we can confidently assume that a flux measurement is likely due to a genuine source and not apart of the underlying noise distribution i.e a spurious noise spike. We calculate the flux upper limit <span class="math notranslate nohighlight">\(F_{UL}\)</span> by:</p>
<div class="math notranslate nohighlight">
\[F_{UL} = [n + \sqrt{2}\times \mathit{erf} ^{-1}(2\beta{\prime} - 1)]\sigma_{bkg}\]</div>
<p>where <em>n</em> is the confidence of the measure (typically set to <em>3</em>, equivalent to a <span class="math notranslate nohighlight">\(3\sigma\)</span> confidence),  <span class="math notranslate nohighlight">\(\mathit{erf}^{-1}\)</span> is the <a class="reference external" href="https://mathworld.wolfram.com/Erf.html">Inverse Error function</a>, <span class="math notranslate nohighlight">\(\beta{\prime}\)</span> is the desired confidence of the measurement, and <span class="math notranslate nohighlight">\(n\sigma_{bkg}\)</span> is the standard deviation of the background noise distribution.</p>
<p>Credit: <a class="reference external" href="http://web.ipac.caltech.edu/staff/fmasci/home/mystats/UpperLimits_FM2011.pdf">F. Masci</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>float</em>) – Level above background to be considered a genuine detection. Typical values are <span class="math notranslate nohighlight">\(n = 3\)</span>, which equations to a <span class="math notranslate nohighlight">\(3\sigma\)</span> confidence level, or in other words there is a 0.135% probability that the measured flux is a spurious noise spike.</p></li>
<li><p><strong>beta_p</strong> (<em>float</em><em>, </em><em>optional</em>) – Probability that a flux measurement is likely due to a genuine source and not apart of the underlying noise distribution. Set to  <span class="math notranslate nohighlight">\(0 \rightarrow 1\)</span>, although a more realistic range  <span class="math notranslate nohighlight">\(0.5 \rightarrow 0.98\)</span>.  Defaults to 0.75</p></li>
<li><p><strong>sigma</strong> (<em>flost</em>) – Standard deviation of background</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Flux upper limit that allows use to place a confidence on a measure given by the <span class="math notranslate nohighlight">\(\beta{\prime}\)</span> term.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.gauss_1d">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">gauss_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.gauss_1d" title="Permalink to this definition"></a></dt>
<dd><p>1D gaussian function given by:</p>
<div class="math notranslate nohighlight">
\[G = A \times e^{-\frac{x-x_o}{2\times \sigma^2}}\]</div>
<p>where <em>G</em> is the 1D gaussian function, <em>A</em> is the amplitude, <em>x</em> is the linear
range of the function, <span class="math notranslate nohighlight">\(x_0\)</span> is the center of the function, and
<span class="math notranslate nohighlight">\(\sigma\)</span> is the standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>1D array</em>) – Linear range of gaussian function</p></li>
<li><p><strong>A</strong> (<em>float</em>) – Amplitude of gaussian function</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – Center/maximum of gaussian function</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – sigma/width of gaussian function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns 1 dimensional function with length equal to length of input x</p>
</dd>
</dl>
<p>array
:rtype: 1D array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.gauss_2d">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">gauss_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.gauss_2d" title="Permalink to this definition"></a></dt>
<dd><p>2D gaussian function given by:</p>
<div class="math notranslate nohighlight">
\[G = A \times e^{-\frac{(x-x_o)^2 - (y-y_0)^2}{2\times \sigma^2}} + sky\]</div>
<p>where <em>G</em> is the 2D gaussian function, <em>A</em> is the amplitude, <em>x</em> and <em>y</em> are the linear
range of the function, <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(y_0\)</span> are the centers of the function,
<span class="math notranslate nohighlight">\(\sigma\)</span> is the standard deviation, and <em>sky</em> is the amplitude offset of the function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>2D array</em>) – 2 dimensional grid to map Gaussian onto</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – x-center of gaussian function</p></li>
<li><p><strong>y0</strong> (<em>float</em>) – y-center of gaussian function</p></li>
<li><p><strong>sky</strong> (<em>float</em>) – sky/offset of gaussian function</p></li>
<li><p><strong>A</strong> (<em>float</em>) – Amplitude of gaussian function</p></li>
<li><p><strong>image_params</strong> (<em>dict</em>) – Dictionary containing the key <em>sigma</em> with corresponding value</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2D gaussian function with the same shape as image input</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.gauss_fwhm2sigma">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">gauss_fwhm2sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.gauss_fwhm2sigma" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Convert  full width half maximum (FWHM) for gaussian</p>
</div></blockquote>
<p>function to sigma value. The FWHM of a gaussian is then given by:</p>
<div class="math notranslate nohighlight">
\[\sigma= \frac{FWHM}{2\times \sqrt{2\times Log_e(2)}}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fwhm</strong> (<em>float</em>) – full width half maximum of the gaussian profile</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sigma value (standard deviation) of the gaussian profile</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.gauss_sigma2fwhm">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">gauss_sigma2fwhm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.gauss_sigma2fwhm" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Convert sigma value to full width half maximum (FWHM) for gaussian</p>
</div></blockquote>
<p>function. The FWHM of a gaussian is then given by:</p>
<div class="math notranslate nohighlight">
\[FWHM = 2\times \sqrt{2\times Log_e(2)}\times \sigma\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is the standard deviation of the Gaussian profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image_params</strong> – Dictionary containing the key <em>sigma</em> with corresponding</p>
</dd>
</dl>
<p>value
:type image_params: dict
:return: Full width half maximum value
:rtype: float</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.get_distinct_colors">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">get_distinct_colors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.get_distinct_colors" title="Permalink to this definition"></a></dt>
<dd><p>Given a number of colors desired, <span class="math notranslate nohighlight">\(\mathit{n}\)</span> generate a list of :math:<a href="#id11"><span class="problematic" id="id12">`</span></a>mathit{n} approximately distinct colours.</p>
<p>Credit: <a class="reference external" href="https://stackoverflow.com/questions/37299142/how-to-set-a-colormap-which-can-give-me-over-20-distinct-colors-in-matplotlib">StackOverflow</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em>) – number of desired distinct colours</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of rgb colours to be used in figure</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.getheader">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">getheader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.getheader" title="Permalink to this definition"></a></dt>
<dd><p>Robust function to get header from <span class="math notranslate nohighlight">\(FITS\)</span> image for use in AutoPHOT. Due to a <span class="math notranslate nohighlight">\(FITS\)</span> image typically having multiple headers, which may have useful important information spread across multiples heres, this function returns (if appropriate) a single header file containing all needed header files. This function aims to find correct telescope header info based on “Telescop” header key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fpath</strong> (<em>str</em>) – Location of fits image which contains a header file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>header information</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>header object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.getimage">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">getimage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.getimage" title="Permalink to this definition"></a></dt>
<dd><p>For a given <span class="math notranslate nohighlight">\(\mathit{FITS}\)</span> file, search through header a look for 2D image using the “<span class="math notranslate nohighlight">\(\mathit{sci}\)</span>” attribute. A error is raise if the image found is not a 2D array e.g. if a <span class="math notranslate nohighlight">\(\mathit{FITS\ cube}\)</span> is given,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fpath</strong> (<em>str</em>) – File path towards <span class="math notranslate nohighlight">\(\mathit{FITS}\)</span> file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2D image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.moffat_2d">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">moffat_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.moffat_2d" title="Permalink to this definition"></a></dt>
<dd><p>Returns 2D moffat function which is given by:</p>
<div class="math notranslate nohighlight">
\[M = A\times (1+\frac{(x-x_o)^2 + (y-y_0)^2}{\sigma^2})^{-\beta} +\]</div>
<p>sky</p>
<p><a class="reference external" href="https://www.ltam.lu/physique/astronomy/projects/star_prof/star_prof.html">Credit: ltam</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>2D  array</em>) – 2 dimensions grid to map Moffat on</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – x-center of Moffat function</p></li>
<li><p><strong>y0</strong> (<em>float</em>) – y-center of Moffat function</p></li>
<li><p><strong>sky</strong> (<em>float</em>) – sky/offset of Moffat function</p></li>
<li><p><strong>A</strong> (<em>float</em>) – Amplitude of Moffat function</p></li>
<li><p><strong>image_params</strong> – Dictionary containing the keys “alpha” and “beta” with</p></li>
</ul>
</dd>
</dl>
<p>their corresponding values
:type image_params: dict
:return: 2D Moffat function with the same shape as image input
:rtype: 2D  array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.moffat_fwhm">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">moffat_fwhm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.moffat_fwhm" title="Permalink to this definition"></a></dt>
<dd><p>Calculate FWHM from Moffat function using:</p>
<div class="math notranslate nohighlight">
\[FWHM = 2 \times lpha \times \sqrt{2^{\frac{1}{\beta}}-1}\]</div>
<p>where <span class="math notranslate nohighlight">\(lpha\)</span> corresponds to the width of moffat function and <span class="math notranslate nohighlight">\(\beta\)</span> describes the wings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image_params</strong> (<em>dict</em>) – Dictionary containing 2 keys: <em>alpha</em> corresponding to the fitted width of the moffat function and <em>beta</em> describing the wings.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Full width half maximum of moffat function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.norm">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.norm" title="Permalink to this definition"></a></dt>
<dd><p>Normalise array to between 0 and 1 while ignoring nans using the following:</p>
<div class="math notranslate nohighlight">
\[|A| = \frac{A - min(A)}{max(A)-min(A)}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>array</strong> (<em>arrat</em>) – array of values</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Normalised array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>arrat</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.order_shift">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">order_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.order_shift" title="Permalink to this definition"></a></dt>
<dd><p>Get the order of magnitude of an array. Use to shift array to between 0-10: The fucntion uses the following equation to find the order of magnitude of an array.</p>
<div class="math notranslate nohighlight">
\[order\_of\_mag (x) = 10^{MAX(FLOOR(Log_{10}(x)))}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>float</em>) – Array of values</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Order of magnitude</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.pix_dist">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">pix_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.pix_dist" title="Permalink to this definition"></a></dt>
<dd><p>Find the linear distance between two sets of points (x1,y1) -&gt; (x2,y2) 
given by:</p>
<div class="math notranslate nohighlight">
\[d = \sqrt{(x_1 - x_2) + (y_1 - y_2)^2}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> (<em>float</em>) – x position of point 1</p></li>
<li><p><strong>x2</strong> (<em>float</em>) – x position of point 2</p></li>
<li><p><strong>y1</strong> (<em>float</em>) – y position of point 1</p></li>
<li><p><strong>y2</strong> (<em>float</em>) – y position of point 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Distance between to points</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.pixel2arcsec">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">pixel2arcsec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.pixel2arcsec" title="Permalink to this definition"></a></dt>
<dd><p>Convert distance in pixel to distance in arcsecs using the following equation:</p>
<div class="math notranslate nohighlight">
\[arcsec = pixel \times 3600 \times pixel\_scale\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>float</em>) – linear distance in pixels</p></li>
<li><p><strong>pixel_scale</strong> (<em>float</em>) – Pixel scale of image in degrees. This is typically the output format when using Astropy’s <span class="math notranslate nohighlight">\(wcs.utils.proj\_plane\_pixel\_scales(w)\)</span> function, where <span class="math notranslate nohighlight">\(w\)</span> is an images WCS object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>linear distance in arcseconds</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.rebin">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">rebin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.rebin" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Rebin an array into a specific 2D shape</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>array</em>) – Array of values</p></li>
<li><p><strong>new_shape</strong> (<em>tuple</em>) – New shape with which to rebin array into</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rebinned array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.round_half">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">round_half</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.round_half" title="Permalink to this definition"></a></dt>
<dd><p>Round a number to half integer values i.ie +/-0.5</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>number</strong> (<em>array</em>) – Values to be rounded</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Values rounded to their nearest 0.5</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.scale_roll">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">scale_roll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.scale_roll" title="Permalink to this definition"></a></dt>
<dd><p>Used in building PSF function. When shiting and aligning residual tables this
functions translates pixel shifts between different images cutouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>gloat</em>) – pixel position</p></li>
<li><p><strong>xc</strong> (<em>float</em>) – pixel position to which we want to move to</p></li>
<li><p><strong>m</strong> (<em>int</em>) – scale multiplier</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DESCRIPTION</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.set_size">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">set_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.set_size" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Function to generate size of figures produced by AutoPhot. To specify the dimensions of a figure in matplotlib we use the figsize argument. However, the figsize argument takes inputs in inches and we have the width of our document in pts. To set the figure size we construct a function to convert from pts to inches and to determine an aesthetic figure height using the golden ratio. The golden ratio is given by:</p>
<div class="math notranslate nohighlight">
\[\phi = (5^{0.5} + 1) / 2 \approx 1.618\]</div>
</div></blockquote>
<p>The ratio of the given width and height is set to the golden ratio</p>
<p>Credit: <a class="reference external" href="https://jwalton.info/Embed-Publication-Matplotlib-Latex/">jwalton.info</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>width</strong> (<em>float</em>) – Width of figure in pts. 1pt == 1/72 inches</p></li>
<li><p><strong>aspect</strong> (<em>float</em>) – Aspect of image i.e. <span class="math notranslate nohighlight">\(height  = width / \phi \times \mathit{aspect}\)</span>, default  = 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns tuple of width, height in inches ready for use.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.to_latex">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">to_latex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autophot_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.to_latex" title="Permalink to this definition"></a></dt>
<dd><p>work in progress</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.trim_zeros_slices">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">trim_zeros_slices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.trim_zeros_slices" title="Permalink to this definition"></a></dt>
<dd><p>TriM a 2D array of horizontal or vertical rows completely filled with zeroes. This is useful when aligning two images When  doing so if there isn’t significant overlap between the two images, the resultant images may have vertical and horizontal lines completely filled with zeroes. This function will accept an image with said zeroed columns/row and return a smaller image with those arrays removed. This function will not exclude partially filled columns or rows.</p>
<p>Credit: <a class="reference external" href="https://stackoverflow.com/questions/55917328/numpy-trim-zeros-in-2d-or-3d">Stackoverflow</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>2D array.</em>) – 2D array with horizontal or vertical rows/columns filled with zeroes.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2D array which has been cleaned of zero columns and index map for original array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.functions.weighted_avg_and_std">
<span class="sig-prename descclassname"><span class="pre">packages.functions.</span></span><span class="sig-name descname"><span class="pre">weighted_avg_and_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.functions.weighted_avg_and_std" title="Permalink to this definition"></a></dt>
<dd><p>Return the average of an array of values with given weights</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>array</em>) – array of values</p></li>
<li><p><strong>weights</strong> (<em>array</em>) – weights associated with values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weighted average and varience</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="packages-get-template-module">
<h2>packages.get_template module<a class="headerlink" href="#packages-get-template-module" title="Permalink to this headline"></a></h2>
</div>
<div class="section" id="module-packages.lightcurve">
<span id="packages-lightcurve-module"></span><h2>packages.lightcurve module<a class="headerlink" href="#module-packages.lightcurve" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.lightcurve.plot_lightcurve">
<span class="sig-prename descclassname"><span class="pre">packages.lightcurve.</span></span><span class="sig-name descname"><span class="pre">plot_lightcurve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fits_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcsv_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'REDUCED'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'REDUCED'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sn_peak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_error_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_colour_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_REBIN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_color_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.lightcurve.plot_lightcurve" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-packages.limit">
<span id="packages-limit-module"></span><h2>packages.limit module<a class="headerlink" href="#module-packages.limit" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.limit.PointsInCircum">
<span class="sig-prename descclassname"><span class="pre">packages.limit.</span></span><span class="sig-name descname"><span class="pre">PointsInCircum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.limit.PointsInCircum" title="Permalink to this definition"></a></dt>
<dd><p>Generate series of x,y coordinates a distance r from the center of the image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>Float</em>) – Distance from center of image</p></li>
<li><p><strong>shape</strong> (<em>Tuple</em>) – Image shape</p></li>
<li><p><strong>n</strong> (<em>Integer</em><em>, </em><em>optional</em>) – Number of points, defaults to 8</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of x,y coorindates placed around the center of the image  at angles 2*pi/n * i for each ith sources in the n sample size</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.limit.flatten_dict">
<span class="sig-prename descclassname"><span class="pre">packages.limit.</span></span><span class="sig-name descname"><span class="pre">flatten_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.limit.flatten_dict" title="Permalink to this definition"></a></dt>
<dd><p>Flatten nested dictionary into single dictionary with keys:values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> (<em>dict</em>) – Nested Dictionary</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Singular dictionary</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.limit.inject_sources">
<span class="sig-prename descclassname"><span class="pre">packages.limit.</span></span><span class="sig-name descname"><span class="pre">inject_sources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeropoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_in_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_out_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">explore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injected_sources_use_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdnoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_lmag_use_ap_phot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_moffat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regrid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detection_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkg_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_recover_dmag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_recover_fine_dmag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_mag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">21</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_recover_nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_recover_dmag_redo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_sources_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_cutoff_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtraction_ready</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unity_PSF_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_add_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injected_sources_additional_sources_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injected_sources_additional_sources_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_injected_sources_randomly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">injected_sources_save_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_cutouts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmag_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_plot_to_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'least_sqaure'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_local</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_surface</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.limit.inject_sources" title="Permalink to this definition"></a></dt>
<dd><p>Package to find limiting magnitude using artifical source injection. This is
the most rebust package available to find a meaningful limiting magnitude for a
location on an image. Given a image (perhaps a image with a suspected tranaient
in the image center), the code will the perform the following tasks to find the
limiting magnitude or the briggest a source can be an be confidently assumed to
be <em>not</em> apart of the background noise distribution:</p>
<p>#.  Setup locations around the transient site (i.e. the center of the image).
For convergence reasons these area should <em>fail</em> the detection criteria e.g.
have a S/N &lt; 3 or <span class="math notranslate nohighlight">\(\beta\prime&lt;0.5\)</span>. If selected, these source posiiton
may be extended to include subpixel positions.</p>
<p>#.  Beginning with an initial guess (either given in the function or assumed),
find the detection details (e.g S/N &gt;3 or <span class="math notranslate nohighlight">\(\beta\prime&gt;0.75\)</span>) for an
intial round of artifical sources. If Selected these sources may have random
noise added to them, to fully explore the probability of a certain magnitude
being recovered.</p>
<p>#.  <em>If the initial sources are detected</em>, decrease the magnitude by a large
step size until the sources are no longer detected. In this scenario we expect
to overshoot the limiting magnitude. We will then increase the magnitude by a
smaller amount until the sources are the recovered to a significant level.</p>
<p>#.  <em>If the initial sources are not detected</em>: In this scenario the initial
guess at the limiting magnitude is too faint. The injected magnitude is
increased (i.e. gets brighter) by a large step size until a significant number
of sources are detected. Again we expect to overshoot the limiting magnitude.
The injected sources are then decreased in magnitude until a significant number
of sources are lost.</p>
<ol class="arabic simple">
<li><p>The penultimate injected magnitude is set at the limiting magnitude.</p></li>
</ol>
<p>This can be a very robust function that can fully sample the surrounding
location of a suspected transient. <em>However</em> if the transient has significant
flux, i.e. it is severly present in the image or the location is severly
contaminated by background galaxy contamination, this is due to the possibility
of one side of the image being <em>more</em> contaminated then the other. Further work
will better account for this issue.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>2D array</em>) – 2D image with transient location at its center</p></li>
<li><p><strong>fwhm</strong> (<em>float</em>) – Full Wdith Half Maximum of image, this is used to space sources significantly away from the transient site</p></li>
<li><p><strong>fpath</strong> (<em>str</em>) – Filepath of image- this is used to save any plots and name them accordingly</p></li>
<li><p><strong>exp_time</strong> (<em>float</em>) – Expsure time in seconds. Use doe Signal to noise calculations</p></li>
<li><p><strong>ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as standard aperture size, defaults to 1.7</p></li>
<li><p><strong>zeropoint</strong> (<em>float</em><em>, </em><em>optional</em>) – Zeropoint offset for image, used to convert given limiting magnitude guess to instrumental magnitude, defaults to 0</p></li>
<li><p><strong>r_in_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as inner radius of background annulus, defaults to 1.9</p></li>
<li><p><strong>r_out_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as outer radius of background annulus, defaults to 2.2</p></li>
<li><p><strong>explore</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION, defaults to False</p></li>
<li><p><strong>injected_sources_use_beta</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use the <span class="math notranslate nohighlight">\(eta\)</span> citeria, else use the more traditional detection limit., defaults to False</p></li>
<li><p><strong>beta_limit</strong> (<em>float</em><em>, </em><em>optional</em>) – Probability limit below which a source is deemed lost, defaults to 0.75</p></li>
<li><p><strong>gain</strong> (<em>float</em><em>, </em><em>optiona</em>) – GAIN on CCD in <span class="math notranslate nohighlight">\(e^{-} /  ADU\)</span> , defaults to 1.</p></li>
<li><p><strong>rdnoise</strong> (<em>float</em><em>, </em><em>optional</em>) – Read noise of CCD in <span class="math notranslate nohighlight">\(e^{-} /  pixel\)</span>, defaults to 0.</p></li>
<li><p><strong>inject_lmag_use_ap_phot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, recover injected sources using aperture photometry. This is typically faster that recovering the sources using PSF photometry, defaults to True</p></li>
<li><p><strong>use_moffat</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use a moffat function for FWHM fitting defaults to True</p></li>
<li><p><strong>fitting_radius</strong> (<em>float</em><em>, </em><em>optional</em>) – zoomed region around location of best fit to focus fitting. This allows for the fitting to be concentrated on high S/N areas and not fit the low S/N wings of the PSF, defaults to 1.3</p></li>
<li><p><strong>regrid_size</strong> (<em>int</em><em>, </em><em>optional</em>) – When expanding to larger pseudo-resolution, what zoom factor to use, defaults to 10</p></li>
<li><p><strong>detection_limit</strong> (<em>float</em><em>, </em><em>optional</em>) – Detection significance level, defaults to 3</p></li>
<li><p><strong>bkg_level</strong> (<em>float</em><em>, </em><em>optional</em>) – The number of standard deviations, below which is assumed to be due to the background noise distribution, defaults to 3</p></li>
<li><p><strong>inject_source_recover_dmag</strong> (<em>float</em><em>, </em><em>optional</em>) – Large magnitude step size , defaults to 0.5</p></li>
<li><p><strong>inject_source_recover_fine_dmag</strong> (<em>float</em><em>, </em><em>optional</em>) – Fine magnitude step size, which needs to be smaller than <em>inject_source_recover_dmag</em>. This value defines the percision of the limiting magnitude, defaults to 0.05</p></li>
<li><p><strong>inject_source_mag</strong> (<em>float</em><em>, </em><em>optional</em>) – if No guess is given, use this magnitude as a start point. Needs <em>zeropoint</em> to be defined, defaults to 21</p></li>
<li><p><strong>inject_source_recover_nsteps</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum allowed number of steps, defaults to 50</p></li>
<li><p><strong>inject_source_recover_dmag_redo</strong> (<em>int</em><em>, </em><em>optional</em>) – When adding noise, how many times do you wish to add a source, each time with a different noise added onto it, defaults to 3</p></li>
<li><p><strong>inject_source_sources_no</strong> – DESCRIPTION, defaults to 10</p></li>
<li><p><strong>inject_source_cutoff_limit</strong> (<em>float</em><em>, </em><em>optional</em>) – Fraction of sources needed to be <em>lost</em> to determine the limiting magnitude, defaults to 0.8</p></li>
<li><p><strong>subtraction_ready</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, image is template subtracted and the noise floor is assumed to be set to zero, defaults to False</p></li>
<li><p><strong>unity_PSF_counts</strong> (<em>float</em><em>, </em><em>optional</em>) – Number of counts under a PSF with amlpitude equal to 1, defaults to None</p></li>
<li><p><strong>inject_source_add_noise</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True add noise to any injected artifical sources, defaults to False</p></li>
<li><p><strong>inject_source_location</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM which defines the distance from the center of time image where to place the artifical sources, defaults to 3</p></li>
<li><p><strong>injected_sources_additional_sources_position</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – Multiple of FWHM around predefined sites where to inject additional sources, set to -1 to perform subpiel movements, defaults to 1</p></li>
<li><p><strong>injected_sources_additional_sources_number</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of additional sources to inject around predefined sites, defaults to 3</p></li>
<li><p><strong>plot_injected_sources_randomly</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, inject sources randomly around the image to demostrate the limiting magnitude, if False, plot sources radialy around image center, defaults to True</p></li>
<li><p><strong>injected_sources_save_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, produce plot of limiting magnitude iterative search and save csv file containing the plotted information, defaults to False</p></li>
<li><p><strong>model</strong> (<em>function</em><em>, </em><em>optional</em>) – PSF model to be used for artifial source inject, if None using a gaussian model, defaults to None</p></li>
<li><p><strong>r_table</strong> (<em>2D array</em>) – Resiudal table, normailised to unity that is the same shape as the base analytical function</p></li>
<li><p><strong>lmag_guess</strong> (<em>float</em><em>, </em><em>optional</em>) – Inital guess at the limting magnitude, zeropooiunt needs to be defined , defaults to None</p></li>
<li><p><strong>print_progress</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, print the status of the limiting magnitude search to screen, defaults to True</p></li>
<li><p><strong>fitting_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Fitting method when fitting the PSF model, defaults to ‘least_square’</p></li>
<li><p><strong>remove_bkg_local</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, use the local median of the image and subtract this to produce a background free image, see above, defaults to True</p></li>
<li><p><strong>remove_bkg_surface</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, use the background fitted surface of the image and subtract this to produce a background free image, see above, defaults to False</p></li>
<li><p><strong>remove_bkg_poly_degree</strong> – If remove_bkg_poly is True, this is the degree of the polynomial fitted to the image, 1 = flat surface, 2 = 2nd order polynomial etc, defaults to 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns the limiting magnitude found via artifical sour injection</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.limit.limiting_magnitude_prob">
<span class="sig-prename descclassname"><span class="pre">packages.limit.</span></span><span class="sig-name descname"><span class="pre">limiting_magnitude_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detection_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkg_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regrid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_sources_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_on_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_random</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_source_add_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_moffat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unity_PSF_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_local</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_surface</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtraction_ready</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_probable_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.limit.limiting_magnitude_prob" title="Permalink to this definition"></a></dt>
<dd><p>Package to employ the same error technique as in the <a class="reference external" href="https://sngroup.oapd.inaf.it/snoopy.html">SNOOPY</a> code. In brief, error
estimates from the transient measurement are obtained through artificial
star experiment in which a fake star of magnitude equal to that of the SN,
is placed in the PSF-fit residual image 
in a position close to, but not coincident with that of the real source.
The artifically injects ource is then recovered in an identical manner to
the original transient magnitude. This is repeated several times. The
dispersion of these recoevred measurements is then taken as the error on
the transient measurement and added in quadrature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>2D array</em>) – Image containing transietnf flux</p></li>
<li><p><strong>fwhm</strong> (<em>float</em>) – Full Width Half Maximum of image. This is used to constrain the position of the injected sources</p></li>
<li><p><strong>PSF_model</strong> (<em>callable function</em>) – PSF model that is used to fit transient flux, this will also be used to inject the artifical sources</p></li>
<li><p><strong>image_params</strong> (<em>dict</em>) – Dictionary containing analytical model params. If a moffat is used, this dictionary should containing <em>alpha</em> and <em>beta</em> and their respective values, else if a gaussian is used, this dictionary should include <em>sigma</em> and its value.</p></li>
<li><p><strong>exp_time</strong> (<em>float</em>) – Exposure time ins seconds of an image. This is used to calculate the S/N of a potential source.</p></li>
<li><p><strong>unity_PSF_counts</strong> (<em>float</em><em>, </em><em>optional</em>) – Number of counts under a PSF model with amplitude equal to 1, defaults to None</p></li>
<li><p><strong>target_error_compute_multilocation_number</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of times the psuedo-transient PSF will be reinjected at locations radially around the original SN site, defaults to 5</p></li>
<li><p><strong>target_error_compute_multilocation_position</strong> (<em>float</em><em>, </em><em>optional</em>) – Multipl of FWHM with which to place the psuedo-transient PSF away from the original site of best fit. Set to -1 to perform sub pixel injection and recovery, defaults to 1</p></li>
<li><p><strong>use_moffat</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use a moffat function for FWHM fitting defaults to True</p></li>
<li><p><strong>fitting_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Fitting method when fitting the PSF model, defaults to ‘least_square’</p></li>
<li><p><strong>ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as standard aperture size, defaults to 1.7</p></li>
<li><p><strong>fitting_radius</strong> (<em>float</em><em>, </em><em>optional</em>) – zoomed region around location of best fit to focus fitting. This allows for the fitting to be concentrated on high S/N areas and not fit the low S/N wings of the PSF, defaults to 1.3</p></li>
<li><p><strong>regrid_size</strong> (<em>int</em><em>, </em><em>optional</em>) – When expanding to larger pseudo-resolution, what zoom factor to use, defaults to 10</p></li>
<li><p><strong>xfit</strong> (<em>float</em><em>, </em><em>optional</em>) – X pixel location of best fit for the transient psf in the image, defaults to None</p></li>
<li><p><strong>yfit</strong> (<em>float</em><em>, </em><em>optional</em>) – y pixel location of best fit for the transient psf in the image, defaults to None</p></li>
<li><p><strong>Hfit</strong> (<em>float</em><em>, </em><em>optional</em>) – PSF amplitude of best fit for the transient psf in the image, defaults to None, defaults to None</p></li>
<li><p><strong>r_table</strong> (<em>2D array</em>) – Resiudal table, normailised to unity that is the same shape as the base analytical function</p></li>
<li><p><strong>remove_bkg_local</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, use the local median of the image and subtract this to produce a background free image, see above, defaults to True</p></li>
<li><p><strong>remove_bkg_surface</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, use the background fitted surface of the image and subtract this to produce a background free image, see above, defaults to False</p></li>
<li><p><strong>remove_bkg_poly_degree</strong> – If remove_bkg_poly is True, this is the degree of the polynomial fitted to the image, 1 = flat surface, 2 = 2nd order polynomial etc, defaults to 1</p></li>
<li><p><strong>bkg_level</strong> (<em>float</em><em>, </em><em>optional</em>) – The number of standard deviations, below which is assumed to be due to the background noise distribution, defaults to 3</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns the standard deviation of the recovered magnitudes of the artifically injection pseudo-transient PSFs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.limit.ranks">
<span class="sig-prename descclassname"><span class="pre">packages.limit.</span></span><span class="sig-name descname"><span class="pre">ranks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.limit.ranks" title="Permalink to this definition"></a></dt>
<dd><p>Return the ranks of each element in an integer sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sample</strong> (<em>array-like</em>) – sample of intergers</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return the ranks of each element in an integer sample</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sorted list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.limit.sample_with_minimum_distance">
<span class="sig-prename descclassname"><span class="pre">packages.limit.</span></span><span class="sig-name descname"><span class="pre">sample_with_minimum_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">40]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.limit.sample_with_minimum_distance" title="Permalink to this definition"></a></dt>
<dd><p>Sample of k elements from range(n), with a minimum distance d.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>tuple</em>) – range of  values</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of points</p></li>
<li><p><strong>d</strong> (<em>float</em>) – distance between each points</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of tuples containing (x,y) location of points seperated by distance(d)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-packages.main">
<span id="packages-main-module"></span><h2>packages.main module<a class="headerlink" href="#module-packages.main" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.main.main">
<span class="sig-prename descclassname"><span class="pre">packages.main.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autophot_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.main.main" title="Permalink to this definition"></a></dt>
<dd><p>Main function in AutoPHOT to perform photometric reduction and calibration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object_info</strong> (<em>Dictionary</em>) – Dictionary containing transient coordinates</p></li>
<li><p><strong>autophot_input</strong> (<em>TYPE</em>) – Main AutoPHOT command dictionary</p></li>
<li><p><strong>fpath</strong> (<em>str</em>) – File path for <em>FITS</em> image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Executions photometric calibration and reduction steps, as well as necessary WCS correction and limiting magnitude tests.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Output files</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-packages.psf">
<span id="packages-psf-module"></span><h2>packages.psf module<a class="headerlink" href="#module-packages.psf" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.psf.PSF_MODEL">
<span class="sig-prename descclassname"><span class="pre">packages.psf.</span></span><span class="sig-name descname"><span class="pre">PSF_MODEL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_moffat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regrid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.psf.PSF_MODEL" title="Permalink to this definition"></a></dt>
<dd><p>Function that returns a “fitted-able” PSF model. The PSF model has the general format off:</p>
<div class="math notranslate nohighlight">
\[PSF(x,y,A) = G/M(x,y,A) + R(x,y,A)\]</div>
<p>where <em>G/M</em> is our base analytical function of a fixed Full Width Half Maximum and <em>R</em> is the residual table, with the same shape as the analytical function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xc</strong> (<em>float</em>) – Best fitted X position of the PSF model</p></li>
<li><p><strong>yc</strong> (<em>float</em>) – Best fitted Y position of the PSF model</p></li>
<li><p><strong>sky</strong> (<em>float</em>) – Sky background offset</p></li>
<li><p><strong>H</strong> (<em>float</em>) – Best fitted amplitude of PSF model</p></li>
<li><p><strong>r_table</strong> (<em>2D array</em>) – Resiudal table, normailised to unity that is the same shape as the base analytical function</p></li>
<li><p><strong>fwhm</strong> (<em>float</em>) – FWHM value used in the analytical function</p></li>
<li><p><strong>image_params</strong> (<em>dict</em>) – Dictionary containing analytical model params. If a moffat is used, this dictionary should containing <em>alpha</em> and <em>beta</em> and their respective values, else if a gaussian is used, this dictionary should include <em>sigma</em> and its value.</p></li>
<li><p><strong>use_moffat</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use a moffat fcuntion as the analytical function, else use a gaussian, defaults to True</p></li>
<li><p><strong>fitting_radius</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to use a zoomed in closeup of image, defaults to 1.3</p></li>
<li><p><strong>regrid_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Zoom scale of increased pesudo-resoloution grid, defaults to 10</p></li>
<li><p><strong>slice_scale</strong> (<em>int</em><em>, </em><em>optional</em>) – If the returne PSF model is required to be of a center shape, set <em>slice_scale</em> be half the height/width of the new shape e.g. PSF shape = (<span class="math notranslate nohighlight">\(2 \\times slice\_scale\)</span>,:math:<cite>2 \times slice_scale</cite>), defaults to None</p></li>
<li><p><strong>pad_shape</strong> (<em>tuple of ints</em><em>, </em><em>optional</em>) – If the output PSF shape needs to be larger than in the input gridsize of the residual table set <em>pad_shape</em> be half the height/width of the new shape e.g. PSF shape = (<span class="math notranslate nohighlight">\(2 \\times pad\_shape[0]\)</span>,:math:<cite>2 \times pad_shape[1]</cite>). Does not have to be a sqaure shape, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a PSF model of a desirced shape</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.psf.build_r_table">
<span class="sig-prename descclassname"><span class="pre">packages.psf.</span></span><span class="sig-name descname"><span class="pre">build_r_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_sources</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GAIN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdnoise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_moffat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regrid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_PSF_starlist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_local_stars_for_PSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_templates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_in_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_out_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkg_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_source_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_psf_source_no</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_SNR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_local</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_surface</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'least_sqaure'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_PSF_stars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_PSF_model_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_PSF_models_fits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.psf.build_r_table" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Build the PSF model from bright, well isolated sources in the field.  AutoPHOT</p>
</div></blockquote>
<p>uses “well-behaved” sources to build the PSF model which will then be used to
measure the amplitude of sources in the field. These sources must be have a high S/N,
isolated from their neighbours and have a relatively smooth background. This is done by
building a compound model comprised of an analytical component (such as Gaussian or
Moffat) along with a numerical residual table obtained during the fitting process.  
Bright isolated sources are located and fitted with an analytical function . The best
fit location is noted and the analytic model is subtracted to leave a residual
image . The residual image is resampled onto a finer pixel grid and shifted . The
compound (analytic and residual) PSF model is then normalized to unity. This process is
repeated for several (typically ~10 sources) bright isolated sources, to create an
average residual image. The final step is to resample the average residual image back
to to the original pixel scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_image</strong> (<em>2D array</em>) – 2D array  containing sources</p></li>
<li><p><strong>selected_sources</strong> (<em>DataFrame</em>) – DataFrame object containing <em>xcentroid</em> and <em>ycentroid</em> columns given the XY pixel location of a source. Dataframe may also containing <em>include_fwhm</em> and <em>include_median</em> which should contain either <em>True</em> or <em>False</em> on whether to include a given source based in it’s FWHM and/or background median respectively.</p></li>
<li><p><strong>fwhm</strong> (<em>float</em>) – Full Width Half Maximum (FWHM) of an image</p></li>
<li><p><strong>exp_time</strong> (<em>float</em>) – Exposure time ins seconds of an image. This is used to calculate the S/N of a potential source.</p></li>
<li><p><strong>image_params</strong> (<em>dict</em>) – Dictionary containing analytical model params. If a moffat is used, this dictionary should containing <em>alpha</em> and <em>beta</em> and their respective values, else if a gaussian is used, this dictionary should include <em>sigma</em> and its value.</p></li>
<li><p><strong>fpath</strong> (<em>str</em>) – Filepath of <em>FITS</em> image used.</p></li>
<li><p><strong>GAIN</strong> (<em>float</em><em>, </em><em>optional</em>) – GAIN on CCD in <span class="math notranslate nohighlight">\(e^{-} /  ADU\)</span> , defaults to 1.</p></li>
<li><p><strong>rdnoise</strong> (<em>float</em><em>, </em><em>optional</em>) – Read noise of CCD in <span class="math notranslate nohighlight">\(e^{-} /  pixel\)</span>, defaults to 0.</p></li>
<li><p><strong>use_moffat</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use a moffat function for FWHM fitting defaults to True</p></li>
<li><p><strong>fitting_radius</strong> (<em>float</em><em>, </em><em>optional</em>) – zoomed region around location of best fit to focus fittinƒimage_params:g. This allows for the fitting to be concentrated on high S/N areas and not fit the low S/N wings of the PSF, defaults to 1.3</p></li>
<li><p><strong>regrid_size</strong> (<em>int</em><em>, </em><em>optional</em>) – When expanding to larger pseudo-resolution, what zoom factor to use, defaults to 10</p></li>
<li><p><strong>use_PSF_starlist</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, <em>selected_soures</em> has been provided by the USer and this variable is required to ignore several source cleaning steps, defaults to False</p></li>
<li><p><strong>use_local_stars_for_PSF</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, use sources within a radius given by <em>local_radius</em>, defaults to False</p></li>
<li><p><strong>prepare_templates</strong> (<em>bool</em><em>, </em><em>optional</em>) – IF True, build PSF model on template image, defaults to False</p></li>
<li><p><strong>scale</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of image cutout. Image cutout size = (<span class="math notranslate nohighlight">\(2 \times scale\)</span>, <span class="math notranslate nohighlight">\(2 \times scale\)</span>), defaults to 25</p></li>
<li><p><strong>ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as standard aperture size, defaults to 1.7</p></li>
<li><p><strong>r_in_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as inner radius of background annulus, defaults to 1.9</p></li>
<li><p><strong>r_out_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as outer radius of background annulus, defaults to 2.2</p></li>
<li><p><strong>local_radius</strong> (<em>int</em><em>, </em><em>optional</em>) – Radius to look for PSF sources around target position, defaults to 1500</p></li>
<li><p><strong>bkg_level</strong> (<em>float</em><em>, </em><em>optional</em>) – The number of standard deviations, below which is assumed to be due to the background noise distribution, defaults to 3</p></li>
<li><p><strong>psf_source_no</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of sources used to build PSF model, defaults to 10</p></li>
<li><p><strong>min_psf_source_no</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number  of sources used to build PSF model with. If less than this number of sources are available, PSF photometry is not used, defaults to 3</p></li>
<li><p><strong>construction_SNR</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum S/N ratio require for a source to be used in the PSF model, defaults to 25</p></li>
<li><p><strong>remove_bkg_local</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, use the local median of the image and subtract this to produce a background free image, see above, defaults to True</p></li>
<li><p><strong>remove_bkg_surface</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, use the background fitted surface of the image and subtract this to produce a background free image, see above, defaults to False</p></li>
<li><p><strong>remove_bkg_poly_degree</strong> – If remove_bkg_poly is True, this is the degree of the polynomial fitted to the image, 1 = flat surface, 2 = 2nd order polynomial etc, defaults to 1</p></li>
<li><p><strong>fitting_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Fitting method when fitting the PSF model, defaults to ‘least_square’</p></li>
<li><p><strong>save_PSF_stars</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, save the information on the stars used to build the PSF model, defaults to False</p></li>
<li><p><strong>save_PSF_models_fits</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, save a <em>FITS</em> image of the PSF model, normalised to unity, defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DESCRIPTION</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.psf.compute_multilocation_err">
<span class="sig-prename descclassname"><span class="pre">packages.psf.</span></span><span class="sig-name descname"><span class="pre">compute_multilocation_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PSF_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unity_PSF_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_error_compute_multilocation_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_error_compute_multilocation_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_moffat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'least_sqaure'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regrid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xfit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yfit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hfit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_local</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_surface</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkg_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.psf.compute_multilocation_err" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Package to employ the same error technique as in the <a href="#id14"><span class="problematic" id="id15">`</span></a>SNOOPY</p>
</div></blockquote>
<p>&lt;<a class="reference external" href="https://sngroup.oapd.inaf.it/snoopy.html">https://sngroup.oapd.inaf.it/snoopy.html</a>&gt;`_ code. In brief, error
estimates from the transient measurement are obtained through artificial
star experiment in which a fake star of magnitude equal to that of the SN,
is placed in the PSF-fit residual image 
in a position close to, but not coincident with that of the real source.</p>
<p>The artificially injects source is then recovered in an identical manner to
the original transient magnitude. This is repeated several times. The
dispersion of these recovered measurements is then taken as the error on
the transient measurement and added in quadrature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>2D array</em>) – Image containing transietnf flux</p></li>
<li><p><strong>fwhm</strong> (<em>float</em>) – Full Width Half Maximum of image. This is used to constrain the position of the injected sources</p></li>
<li><p><strong>PSF_model</strong> (<em>callable function</em>) – PSF model that is used to fit transient flux, this will also be used to inject the artifical sources</p></li>
<li><p><strong>image_params</strong> (<em>dict</em>) – Dictionary containing analytical model params. If a moffat is used, this dictionary should containing <em>alpha</em> and <em>beta</em> and their respective values, else if a gaussian is used, this dictionary should include <em>sigma</em> and its value.</p></li>
<li><p><strong>exp_time</strong> (<em>float</em>) – Exposure time ins seconds of an image. This is used to calculate the S/N of a potential source.</p></li>
<li><p><strong>unity_PSF_counts</strong> (<em>float</em><em>, </em><em>optional</em>) – Number of counts under a PSF model with amplitude equal to 1, defaults to None</p></li>
<li><p><strong>target_error_compute_multilocation_number</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of times the psuedo-transient PSF will be reinjected at locations radially around the original SN site, defaults to 5</p></li>
<li><p><strong>target_error_compute_multilocation_position</strong> (<em>float</em><em>, </em><em>optional</em>) – Multipl of FWHM with which to place the psuedo-transient PSF away from the original site of best fit. Set to -1 to perform sub pixel injection and recovery, defaults to 1</p></li>
<li><p><strong>use_moffat</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use a moffat function for FWHM fitting defaults to True</p></li>
<li><p><strong>fitting_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Fitting method when fitting the PSF model, defaults to ‘least_square’</p></li>
<li><p><strong>ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as standard aperture size, defaults to 1.7</p></li>
<li><p><strong>fitting_radius</strong> (<em>float</em><em>, </em><em>optional</em>) – zoomed region around location of best fit to focus fitting. This allows for the fitting to be concentrated on high S/N areas and not fit the low S/N wings of the PSF, defaults to 1.3</p></li>
<li><p><strong>regriding_size</strong> (<em>int</em><em>, </em><em>optional</em>) – When expanding to larger pseudo-resolution, what zoom factor to use, defaults to 10</p></li>
<li><p><strong>xfit</strong> (<em>float</em><em>, </em><em>optional</em>) – X pixel location of best fit for the transient psf in the image, defaults to None</p></li>
<li><p><strong>yfit</strong> (<em>float</em><em>, </em><em>optional</em>) – y pixel location of best fit for the transient psf in the image, defaults to None</p></li>
<li><p><strong>Hfit</strong> (<em>float</em><em>, </em><em>optional</em>) – PSF amplitude of best fit for the transient psf in the image, defaults to None, defaults to None</p></li>
<li><p><strong>r_table</strong> (<em>2D array</em>) – Resiudal table, normailised to unity that is the same shape as the base analytical function</p></li>
<li><p><strong>remove_bkg_local</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, use the local median of the image and subtract this to produce a background free image, see above, defaults to True</p></li>
<li><p><strong>remove_bkg_surface</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, use the background fitted surface of the image and subtract this to produce a background free image, see above, defaults to False</p></li>
<li><p><strong>remove_bkg_poly_degree</strong> – If remove_bkg_poly is True, this is the degree of the polynomial fitted to the image, 1 = flat surface, 2 = 2nd order polynomial etc, defaults to 1</p></li>
<li><p><strong>bkg_level</strong> (<em>float</em><em>, </em><em>optional</em>) – The number of standard deviations, below which is assumed to be due to the background noise distribution, defaults to 3</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns the standard deviation of the recovered magnitudes of the artifically injection pseudo-transient PSFs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.psf.do">
<span class="sig-prename descclassname"><span class="pre">packages.psf.</span></span><span class="sig-name descname"><span class="pre">do</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unity_PSF_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unity_residual_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_moffat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.psf.do" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>We exploit the fact that each point source in an image appears the same, i.e.</p>
</div></blockquote>
<p>the PSF model matches each each, and the only variable that change between each
source is it’s height. We use this function to get the counts under a PDF model
with ampltide equal to 1.</p>
<p>This allows use to scale these counts to any source
fitted with the same PSF later on.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>Dataframe</em>) – Dataframe containing the columns <em>H_PSF</em> and <em>H_PSF_err</em> which corrospsonds to the height of the best fitted PSF and the error associated with that value</p></li>
<li><p><strong>residual_image</strong> (<em>2D array</em><em>, </em><em>optional</em>) – Residual table, normalised to unity that is the same shape as the base analytical function, defaults to None</p></li>
<li><p><strong>ap_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to be used as standard aperture size, defaults to 1.7</p></li>
<li><p><strong>fwhm</strong> (<em>float</em>) – Full Width Half Maximum of image</p></li>
<li><p><strong>unity_PSF_counts</strong> (<em>float</em><em>, </em><em>optional</em>) – Number of counts under a PSF model with amplitude equal to 1, if this value is left as None, and the residual table is given, this value is calculated and returned, defaults to None</p></li>
<li><p><strong>unity_residual_counts</strong> (<em>float</em><em>, </em><em>optional</em>) – Number of counts under a residual table normalised to an PSF amplitude equal to 1, defaults to None</p></li>
<li><p><strong>use_moffat</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use a moffat function as the analytical function, else use a gaussian, defaults to True</p></li>
<li><p><strong>image_params</strong> (<em>dict</em>) – Dictionary containing analytical model params. If a moffat is used, this dictionary should containing <em>alpha</em> and <em>beta</em> and their respective values, else if a gaussian is used, this dictionary should include <em>sigma</em> and its value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If <em>unity_PSF_counts</em> is None and the residual is given, this function will calculate and return the value of <em>unity_PSF_counts</em> as well as the counts under the fitted PSF given in the initial dataframe. If <em>unity_PSF_counts</em> is defined, then the counts information is returned only</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.psf.fit">
<span class="sig-prename descclassname"><span class="pre">packages.psf.</span></span><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sources</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regrid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkg_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sat_lvl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">65536</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_moffat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitting_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'least_sqaure'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_background_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hold_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_subtraction_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_closeup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_local</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_surface</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_bkg_poly_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_PSF_residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.psf.fit" title="Permalink to this definition"></a></dt>
<dd><p>Function to fit a given Point Spread Function (PSF) model to a point source located in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>2D array</em>) – 2D array containing point sources</p></li>
<li><p><strong>sources</strong> (<em>Dataframe</em>) – Dataframe containg <em>x_pix</em> and <em>y_pix</em> columns corrospsondong the the XY pixel location in an image</p></li>
<li><p><strong>residual_table</strong> (<em>2D array</em>) – Residual image normalised to unity.</p></li>
<li><p><strong>fwhm</strong> (<em>float</em>) – Full Width Half Maximum of image</p></li>
<li><p><strong>fpath</strong> (<em>str</em>) – Filepath of image. This is used to save plots and figures.</p></li>
<li><p><strong>fitting_radius</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiple of FWHM to use a zoomed in closeup of image, defaults to 1.3</p></li>
<li><p><strong>regrid_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Zoom scale of increased pesudo-resoloution grid, defaults to 10</p></li>
<li><p><strong>bkg_level</strong> (<em>float</em><em>, </em><em>optional</em>) – The number of standard deviations, below which is assumed to be due to the background noise distribution, defaults to 3</p></li>
<li><p><strong>sat_lvl</strong> (<em>float</em><em>, </em><em>optional</em>) – Counts level above which any detected source is deemed saturated and discarded, defaults to 65536</p></li>
<li><p><strong>use_moffat</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use a moffat function for FWHM fitting, else use a Gaussian</p></li>
<li><p><strong>image_params</strong> (<em>dict</em>) – Dictionary containing analytical model params. If a moffat is used, this dictionary should containing <em>alpha</em> and <em>beta</em> and their respective values, else if a gaussian is used, this dictionary should include <em>sigma</em> and its value.</p></li>
<li><p><strong>fitting_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Fitting method when fitting the PSF model, defaults to ‘least_square’</p></li>
<li><p><strong>save_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, save a plot showing the source, it’s fitted PSF and subtraction, defaults to False</p></li>
<li><p><strong>hold_pos</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, don’t let the PSF model adjust its position, only it’s amplitude. This is equivalent to force photometry, defaults to False</p></li>
<li><p><strong>return_fwhm</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, fit the FWHM of the source using the base analytical model and include it in the output dataframe, defaults to False</p></li>
<li><p><strong>no_print</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, do not display the progress of the PSF fitting, defaults to True</p></li>
<li><p><strong>return_closeup</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, retrun the close up image used to fit the PSF model, defaults to False</p></li>
<li><p><strong>remove_bkg_local</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, use the local median of the image and subtract this to produce a background free image, see above, defaults to True</p></li>
<li><p><strong>remove_bkg_surface</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – If True, use the background fitted surface of the image and subtract this to produce a background free image, see above, defaults to False</p></li>
<li><p><strong>remove_bkg_poly_degree</strong> – If remove_bkg_poly is True, this is the degree of the polynomial fitted to the image, 1 = flat surface, 2 = 2nd order polynomial etc, defaults to 1</p></li>
<li><p><strong>plot_PSF_residuals</strong> (<em>Bool</em><em>, </em><em>optional</em>) – If True, plot the residual images from the PSF fitting and subtraction and save them to a directory in <em>file_path</em> called <em>psf_subtractions</em>, defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return a dataframe containing information in the PSF fittings</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dataframe</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="packages-recover-output-module">
<h2>packages.recover_output module<a class="headerlink" href="#packages-recover-output-module" title="Permalink to this headline"></a></h2>
</div>
<div class="section" id="packages-rm-bkg-module">
<h2>packages.rm_bkg module<a class="headerlink" href="#packages-rm-bkg-module" title="Permalink to this headline"></a></h2>
</div>
<div class="section" id="module-packages.run">
<span id="packages-run-module"></span><h2>packages.run module<a class="headerlink" href="#module-packages.run" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="packages.run.recover">
<span class="sig-prename descclassname"><span class="pre">packages.run.</span></span><span class="sig-name descname"><span class="pre">recover</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fits_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'REDUCED'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcsv_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'REDUCED'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infile_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'out.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.run.recover" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Iterate through output folder given by <em>fits_dir</em> and <em>outdir_name</em>, search for files corresponding to <em>outfile_name</em> and concatenate into a single file named <em>outcsv_name</em></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fits_dir</strong> (<em>str</em>) – Location of original directory containing <em>FITS</em> images</p></li>
<li><p><strong>outdir_name</strong> (<em>ste</em><em>, </em><em>optional</em>) – Name of output directory concatenation i.e. what is the name concatenated onto the parent directory from <em>fits_dir</em>, defaults to ‘REDUCED’</p></li>
<li><p><strong>outcsv_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of file to save data which will be saved in <em>outdir_name</em>, defaults to ‘REDUCED’</p></li>
<li><p><strong>infile_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of output file which contains photometric information on each image, defaults to ‘out.csv’</p></li>
<li><p><strong>update_fpath</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, make sure the “<em>fpath</em>” variable in <em>outcsv_name</em> is correct, defaults to True</p></li>
<li><p><strong>print_msg</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True print a message saying that the script is working, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Produces an output csv file with the name given by <em>outcsv_name</em> in the directory given by <em>fits_dir</em> with <em>outdir_name</em> appended onto it.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="packages.run.run_autophot">
<span class="sig-prename descclassname"><span class="pre">packages.run.</span></span><span class="sig-name descname"><span class="pre">run_autophot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autophot_input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#packages.run.run_autophot" title="Permalink to this definition"></a></dt>
<dd><p>Function to run on image dataset and setup list of files for use in AutoPHOT.
This function performs the following tasks:</p>
<p>1. Searches through a given file path and makes list of acceptable images to
use.  This script will look for files with the following extension:</p>
<ol class="arabic simple">
<li><p><em>.fist</em></p></li>
<li><p><em>.fit</em></p></li>
<li><p><em>.fts</em></p></li>
<li><p><em>fits.fz</em></p></li>
</ol>
<p>Science images must not include the following in their filepath as these
filenames are used later on in AutoPHOT (and will end with the same extension
as the input image) and may cause errors:</p>
<ol class="arabic simple">
<li><p><em>subtraction</em></p></li>
<li><p><em>template</em></p></li>
<li><p><em>.wcs.</em></p></li>
<li><p><em>footprint</em></p></li>
<li><p><em>PSF_model_</em></p></li>
<li><p><em>sources_</em></p></li>
</ol>
<p>2. Run through this filelist and check if the correct information is available
in the <em>telescope.yml file using the *checkteledata</em> function.</p>
<p>3. If a Transient Name Server (TNS) bot isavailable, return the latest
coordinates of a given target.</p>
<p>4. Search though the file list and remove any file that has an <em>IMAGETYP</em> of
<em>bias</em>, <em>zero</em>, <em>flat</em>, <em>WAVE</em> , or <em>LAMP</em>  or an <em>OBS_MODE</em> of
<em>spectroscopy</em>.</p>
<ol class="arabic simple" start="5">
<li><p>Run the final file list through the AutoPHoT pipeline</p></li>
</ol>
<p>See <a class="reference external" href="https://github.com/Astro-Sean/autophot/blob/master/example_notebooks/basic_example.ipynb">here</a>
for an example.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>autophot_input</strong> (<em>dict</em>) – AutoPHOT input dictionary</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Creates a csv file containing photometric data for transient indataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dataframe saved to work directory</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="packages-uncertain-module">
<h2>packages.uncertain module<a class="headerlink" href="#packages-uncertain-module" title="Permalink to this headline"></a></h2>
</div>
<div class="section" id="module-packages">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-packages" title="Permalink to this headline"></a></h2>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="autophot_instructions.html" class="btn btn-neutral float-left" title="Commands" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Seán Brennan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>